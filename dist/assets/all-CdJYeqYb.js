var x;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(x||(x={}));function Zr(e){return e.nodeType===e.ELEMENT_NODE}function Je(e){var t=e==null?void 0:e.host;return(t==null?void 0:t.shadowRoot)===e}function Qe(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}function _n(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),e}function Bn(e){var t=e.cssText;if(t.split('"').length<3)return t;var r=["@import","url(".concat(JSON.stringify(e.href),")")];return e.layerName===""?r.push("layer"):e.layerName&&r.push("layer(".concat(e.layerName,")")),e.supportsText&&r.push("supports(".concat(e.supportsText,")")),e.media.length&&r.push(e.media.mediaText),r.join(" ")+";"}function mt(e){try{var t=e.rules||e.cssRules;return t?_n(Array.from(t).map(Hr).join("")):null}catch{return null}}function Hr(e){var t;if(Un(e))try{t=mt(e.styleSheet)||Bn(e)}catch{}return Wn(t||e.cssText)}function Wn(e){if(e.includes(":")){var t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}return e}function Un(e){return"styleSheet"in e}var zt=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var r;if(!t)return-1;var n=(r=this.getMeta(t))===null||r===void 0?void 0:r.id;return n??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var r=this,n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(function(i){return r.removeNodeFromMap(i)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,r){var n=r.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,r)},e.prototype.replace=function(t,r){var n=this.getNode(t);if(n){var i=this.nodeMetaMap.get(n);i&&this.nodeMetaMap.set(r,i)}this.idNodeMap.set(t,r)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Yr(){return new zt}function Kt(e){var t=e.element,r=e.maskInputOptions,n=e.tagName,i=e.type,s=e.value,a=e.maskInputFn,l=s||"",o=i&&Me(i);return(r[n.toLowerCase()]||o&&r[o])&&(a?l=a(l,t):l="*".repeat(l.length)),l}function Me(e){return e.toLowerCase()}var dr="__rrweb_original__";function Vn(e){var t=e.getContext("2d");if(!t)return!0;for(var r=50,n=0;n<e.width;n+=r)for(var i=0;i<e.height;i+=r){var s=t.getImageData,a=dr in s?s[dr]:s,l=new Uint32Array(a.call(t,n,i,Math.min(r,e.width-n),Math.min(r,e.height-i)).data.buffer);if(l.some(function(o){return o!==0}))return!1}return!0}function Pn(e,t){return!e||!t||e.type!==t.type?!1:e.type===x.Document?e.compatMode===t.compatMode:e.type===x.DocumentType?e.name===t.name&&e.publicId===t.publicId&&e.systemId===t.systemId:e.type===x.Comment||e.type===x.Text||e.type===x.CDATA?e.textContent===t.textContent:e.type===x.Element?e.tagName===t.tagName&&JSON.stringify(e.attributes)===JSON.stringify(t.attributes)&&e.isSVG===t.isSVG&&e.needBlock===t.needBlock:!1}function jt(e){var t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?Me(t):null}var Gn=1,Zn=new RegExp("[^a-z0-9-_:]"),et=-2;function zr(){return Gn++}function Hn(e){if(e instanceof HTMLFormElement)return"form";var t=Me(e.tagName);return Zn.test(t)?"div":t}function Yn(e){var t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}var Oe,fr,zn=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Kn=/^(?:[a-z+]+:)?\/\//i,jn=/^www\..*/i,Xn=/^(data:)([^,]*),(.*)/i;function gt(e,t){return(e||"").replace(zn,function(r,n,i,s,a,l){var o=i||a||l,c=n||s||"";if(!o)return r;if(Kn.test(o)||jn.test(o)||Xn.test(o))return"url(".concat(c).concat(o).concat(c,")");if(o[0]==="/")return"url(".concat(c).concat(Yn(t)+o).concat(c,")");var u=t.split("/"),d=o.split("/");u.pop();for(var f=0,h=d;f<h.length;f++){var p=h[f];p!=="."&&(p===".."?u.pop():u.push(p))}return"url(".concat(c).concat(u.join("/")).concat(c,")")})}var Jn=/^[^ \t\n\r\u000c]+/,Qn=/^[, \t\n\r\u000c]+/;function qn(e,t){if(t.trim()==="")return t;var r=0;function n(c){var u,d=c.exec(t.substring(r));return d?(u=d[0],r+=u.length,u):""}for(var i=[];n(Qn),!(r>=t.length);){var s=n(Jn);if(s.slice(-1)===",")s=We(e,s.substring(0,s.length-1)),i.push(s);else{var a="";s=We(e,s);for(var l=!1;;){var o=t.charAt(r);if(o===""){i.push((s+a).trim());break}else if(l)o===")"&&(l=!1);else if(o===","){r+=1,i.push((s+a).trim());break}else o==="("&&(l=!0);a+=o,r+=1}}}return i.join(", ")}function We(e,t){if(!t||t.trim()==="")return t;var r=e.createElement("a");return r.href=t,r.href}function $n(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function Xt(){var e=document.createElement("a");return e.href="",e.href}function Kr(e,t,r,n){return n&&(r==="src"||r==="href"&&!(t==="use"&&n[0]==="#")||r==="xlink:href"&&n[0]!=="#"||r==="background"&&(t==="table"||t==="td"||t==="th")?We(e,n):r==="srcset"?qn(e,n):r==="style"?gt(n,Xt()):t==="object"&&r==="data"?We(e,n):n)}function jr(e,t,r){return(e==="video"||e==="audio")&&t==="autoplay"}function ei(e,t,r){try{if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(var n=e.classList.length;n--;){var i=e.classList[n];if(t.test(i))return!0}if(r)return e.matches(r)}catch{}return!1}function vt(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return r?vt(e.parentNode,t,r):!1;for(var n=e.classList.length;n--;){var i=e.classList[n];if(t.test(i))return!0}return r?vt(e.parentNode,t,r):!1}function Xr(e,t,r){try{var n=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(n===null)return!1;if(typeof t=="string"){if(n.classList.contains(t)||n.closest(".".concat(t)))return!0}else if(vt(n,t,!0))return!0;if(r&&(n.matches(r)||n.closest(r)))return!0}catch{}return!1}function ti(e,t,r){var n=e.contentWindow;if(n){var i=!1,s;try{s=n.document.readyState}catch{return}if(s!=="complete"){var a=setTimeout(function(){i||(t(),i=!0)},r);e.addEventListener("load",function(){clearTimeout(a),i=!0,t()});return}var l="about:blank";if(n.location.href!==l||e.src===l||e.src==="")return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}}function ri(e,t,r){var n=!1,i;try{i=e.sheet}catch{return}if(!i){var s=setTimeout(function(){n||(t(),n=!0)},r);e.addEventListener("load",function(){clearTimeout(s),n=!0,t()})}}function ni(e,t){var r=t.doc,n=t.mirror,i=t.blockClass,s=t.blockSelector,a=t.maskTextClass,l=t.maskTextSelector,o=t.inlineStylesheet,c=t.maskInputOptions,u=c===void 0?{}:c,d=t.maskTextFn,f=t.maskInputFn,h=t.dataURLOptions,p=h===void 0?{}:h,m=t.inlineImages,I=t.recordCanvas,y=t.keepIframeSrcFn,v=t.newlyAddedElement,g=v===void 0?!1:v,b=ii(r,n);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:x.Document,childNodes:[],compatMode:e.compatMode}:{type:x.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:x.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:b};case e.ELEMENT_NODE:return oi(e,{doc:r,blockClass:i,blockSelector:s,inlineStylesheet:o,maskInputOptions:u,maskInputFn:f,dataURLOptions:p,inlineImages:m,recordCanvas:I,keepIframeSrcFn:y,newlyAddedElement:g,rootId:b});case e.TEXT_NODE:return si(e,{maskTextClass:a,maskTextSelector:l,maskTextFn:d,rootId:b});case e.CDATA_SECTION_NODE:return{type:x.CDATA,textContent:"",rootId:b};case e.COMMENT_NODE:return{type:x.Comment,textContent:e.textContent||"",rootId:b};default:return!1}}function ii(e,t){if(t.hasNode(e)){var r=t.getId(e);return r===1?void 0:r}}function si(e,t){var r,n=t.maskTextClass,i=t.maskTextSelector,s=t.maskTextFn,a=t.rootId,l=e.parentNode&&e.parentNode.tagName,o=e.textContent,c=l==="STYLE"?!0:void 0,u=l==="SCRIPT"?!0:void 0;if(c&&o){try{e.nextSibling||e.previousSibling||!((r=e.parentNode.sheet)===null||r===void 0)&&r.cssRules&&(o=mt(e.parentNode.sheet))}catch(d){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(d),e)}o=gt(o,Xt())}return u&&(o="SCRIPT_PLACEHOLDER"),!c&&!u&&o&&Xr(e,n,i)&&(o=s?s(o):o.replace(/[\S]/g,"*")),{type:x.Text,textContent:o||"",isStyle:c,rootId:a}}function oi(e,t){for(var r=t.doc,n=t.blockClass,i=t.blockSelector,s=t.inlineStylesheet,a=t.maskInputOptions,l=a===void 0?{}:a,o=t.maskInputFn,c=t.dataURLOptions,u=c===void 0?{}:c,d=t.inlineImages,f=t.recordCanvas,h=t.keepIframeSrcFn,p=t.newlyAddedElement,m=p===void 0?!1:p,I=t.rootId,y=ei(e,n,i),v=Hn(e),g={},b=e.attributes.length,N=0;N<b;N++){var T=e.attributes[N];jr(v,T.name,T.value)||(g[T.name]=Kr(r,v,Me(T.name),T.value))}if(v==="link"&&s){var k=Array.from(r.styleSheets).find(function(E){return E.href===e.href}),A=null;k&&(A=mt(k)),A&&(delete g.rel,delete g.href,g._cssText=gt(A,k.href))}if(v==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){var A=mt(e.sheet);A&&(g._cssText=gt(A,Xt()))}if(v==="input"||v==="textarea"||v==="select"){var K=e.value,_=e.checked;if(g.type!=="radio"&&g.type!=="checkbox"&&g.type!=="submit"&&g.type!=="button"&&K){var j=jt(e);g.value=Kt({element:e,type:j,tagName:v,value:K,maskInputOptions:l,maskInputFn:o})}else _&&(g.checked=_)}if(v==="option"&&(e.selected&&!l.select?g.selected=!0:delete g.selected),v==="canvas"&&f){if(e.__context==="2d")Vn(e)||(g.rr_dataURL=e.toDataURL(u.type,u.quality));else if(!("__context"in e)){var U=e.toDataURL(u.type,u.quality),G=document.createElement("canvas");G.width=e.width,G.height=e.height;var z=G.toDataURL(u.type,u.quality);U!==z&&(g.rr_dataURL=U)}}if(v==="img"&&d){Oe||(Oe=r.createElement("canvas"),fr=Oe.getContext("2d"));var L=e,F=L.crossOrigin;L.crossOrigin="anonymous";var D=function(){L.removeEventListener("load",D);try{Oe.width=L.naturalWidth,Oe.height=L.naturalHeight,fr.drawImage(L,0,0),g.rr_dataURL=Oe.toDataURL(u.type,u.quality)}catch(E){console.warn("Cannot inline img src=".concat(L.currentSrc,"! Error: ").concat(E))}F?g.crossOrigin=F:L.removeAttribute("crossorigin")};L.complete&&L.naturalWidth!==0?D():L.addEventListener("load",D)}if((v==="audio"||v==="video")&&(g.rr_mediaState=e.paused?"paused":"played",g.rr_mediaCurrentTime=e.currentTime),m||(e.scrollLeft&&(g.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(g.rr_scrollTop=e.scrollTop)),y){var Z=e.getBoundingClientRect(),S=Z.width,C=Z.height;g={class:g.class,rr_width:"".concat(S,"px"),rr_height:"".concat(C,"px")}}return v==="iframe"&&!h(g.src)&&(e.contentDocument||(g.rr_src=g.src),delete g.src),{type:x.Element,tagName:v,attributes:g,childNodes:[],isSVG:$n(e)||void 0,needBlock:y,rootId:I}}function X(e){return e==null?"":e.toLowerCase()}function ai(e,t){if(t.comment&&e.type===x.Comment)return!0;if(e.type===x.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(X(e.attributes.name).match(/^msapplication-tile(image|color)$/)||X(e.attributes.name)==="application-name"||X(e.attributes.rel)==="icon"||X(e.attributes.rel)==="apple-touch-icon"||X(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&X(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(X(e.attributes.property).match(/^(og|twitter|fb):/)||X(e.attributes.name).match(/^(og|twitter):/)||X(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(X(e.attributes.name)==="robots"||X(e.attributes.name)==="googlebot"||X(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(X(e.attributes.name)==="author"||X(e.attributes.name)==="generator"||X(e.attributes.name)==="framework"||X(e.attributes.name)==="publisher"||X(e.attributes.name)==="progid"||X(e.attributes.property).match(/^article:/)||X(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(X(e.attributes.name)==="google-site-verification"||X(e.attributes.name)==="yandex-verification"||X(e.attributes.name)==="csrf-token"||X(e.attributes.name)==="p:domain_verify"||X(e.attributes.name)==="verify-v1"||X(e.attributes.name)==="verification"||X(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function Ue(e,t){var r=t.doc,n=t.mirror,i=t.blockClass,s=t.blockSelector,a=t.maskTextClass,l=t.maskTextSelector,o=t.skipChild,c=o===void 0?!1:o,u=t.inlineStylesheet,d=u===void 0?!0:u,f=t.maskInputOptions,h=f===void 0?{}:f,p=t.maskTextFn,m=t.maskInputFn,I=t.slimDOMOptions,y=t.dataURLOptions,v=y===void 0?{}:y,g=t.inlineImages,b=g===void 0?!1:g,N=t.recordCanvas,T=N===void 0?!1:N,k=t.onSerialize,A=t.onIframeLoad,K=t.iframeLoadTimeout,_=K===void 0?5e3:K,j=t.onStylesheetLoad,U=t.stylesheetLoadTimeout,G=U===void 0?5e3:U,z=t.keepIframeSrcFn,L=z===void 0?function(){return!1}:z,F=t.newlyAddedElement,D=F===void 0?!1:F,Z=t.preserveWhiteSpace,S=Z===void 0?!0:Z,C=ni(e,{doc:r,mirror:n,blockClass:i,blockSelector:s,maskTextClass:a,maskTextSelector:l,inlineStylesheet:d,maskInputOptions:h,maskTextFn:p,maskInputFn:m,dataURLOptions:v,inlineImages:b,recordCanvas:T,keepIframeSrcFn:L,newlyAddedElement:D});if(!C)return console.warn(e,"not serialized"),null;var E;n.hasNode(e)?E=n.getId(e):ai(C,I)||!S&&C.type===x.Text&&!C.isStyle&&!C.textContent.replace(/^\s+|\s+$/gm,"").length?E=et:E=zr();var M=Object.assign(C,{id:E});if(n.add(e,M),E===et)return null;k&&k(e);var H=!c;if(M.type===x.Element){H=H&&!M.needBlock,delete M.needBlock;var J=e.shadowRoot;J&&Qe(J)&&(M.isShadowHost=!0)}if((M.type===x.Document||M.type===x.Element)&&H){I.headWhitespace&&M.type===x.Element&&M.tagName==="head"&&(S=!1);for(var ee={doc:r,mirror:n,blockClass:i,blockSelector:s,maskTextClass:a,maskTextSelector:l,skipChild:c,inlineStylesheet:d,maskInputOptions:h,maskTextFn:p,maskInputFn:m,slimDOMOptions:I,dataURLOptions:v,inlineImages:b,recordCanvas:T,preserveWhiteSpace:S,onSerialize:k,onIframeLoad:A,iframeLoadTimeout:_,onStylesheetLoad:j,stylesheetLoadTimeout:G,keepIframeSrcFn:L},oe=0,ae=Array.from(e.childNodes);oe<ae.length;oe++){var de=ae[oe],fe=Ue(de,ee);fe&&M.childNodes.push(fe)}if(Zr(e)&&e.shadowRoot)for(var O=0,ie=Array.from(e.shadowRoot.childNodes);O<ie.length;O++){var de=ie[O],fe=Ue(de,ee);fe&&(Qe(e.shadowRoot)&&(fe.isShadow=!0),M.childNodes.push(fe))}}return e.parentNode&&Je(e.parentNode)&&Qe(e.parentNode)&&(M.isShadow=!0),M.type===x.Element&&M.tagName==="iframe"&&ti(e,function(){var V=e.contentDocument;if(V&&A){var ne=Ue(V,{doc:V,mirror:n,blockClass:i,blockSelector:s,maskTextClass:a,maskTextSelector:l,skipChild:!1,inlineStylesheet:d,maskInputOptions:h,maskTextFn:p,maskInputFn:m,slimDOMOptions:I,dataURLOptions:v,inlineImages:b,recordCanvas:T,preserveWhiteSpace:S,onSerialize:k,onIframeLoad:A,iframeLoadTimeout:_,onStylesheetLoad:j,stylesheetLoadTimeout:G,keepIframeSrcFn:L});ne&&A(e,ne)}},_),M.type===x.Element&&M.tagName==="link"&&M.attributes.rel==="stylesheet"&&ri(e,function(){if(j){var V=Ue(e,{doc:r,mirror:n,blockClass:i,blockSelector:s,maskTextClass:a,maskTextSelector:l,skipChild:!1,inlineStylesheet:d,maskInputOptions:h,maskTextFn:p,maskInputFn:m,slimDOMOptions:I,dataURLOptions:v,inlineImages:b,recordCanvas:T,preserveWhiteSpace:S,onSerialize:k,onIframeLoad:A,iframeLoadTimeout:_,onStylesheetLoad:j,stylesheetLoadTimeout:G,keepIframeSrcFn:L});V&&j(e,V)}},G),M}function li(e,t){var r=t||{},n=r.mirror,i=n===void 0?new zt:n,s=r.blockClass,a=s===void 0?"rr-block":s,l=r.blockSelector,o=l===void 0?null:l,c=r.maskTextClass,u=c===void 0?"rr-mask":c,d=r.maskTextSelector,f=d===void 0?null:d,h=r.inlineStylesheet,p=h===void 0?!0:h,m=r.inlineImages,I=m===void 0?!1:m,y=r.recordCanvas,v=y===void 0?!1:y,g=r.maskAllInputs,b=g===void 0?!1:g,N=r.maskTextFn,T=r.maskInputFn,k=r.slimDOM,A=k===void 0?!1:k,K=r.dataURLOptions,_=r.preserveWhiteSpace,j=r.onSerialize,U=r.onIframeLoad,G=r.iframeLoadTimeout,z=r.onStylesheetLoad,L=r.stylesheetLoadTimeout,F=r.keepIframeSrcFn,D=F===void 0?function(){return!1}:F,Z=b===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:b===!1?{password:!0}:b,S=A===!0||A==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:A==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:A===!1?{}:A;return Ue(e,{doc:e,mirror:i,blockClass:a,blockSelector:o,maskTextClass:u,maskTextSelector:f,skipChild:!1,inlineStylesheet:p,maskInputOptions:Z,maskTextFn:N,maskInputFn:T,slimDOMOptions:S,dataURLOptions:K,inlineImages:I,recordCanvas:v,preserveWhiteSpace:_,onSerialize:j,onIframeLoad:U,iframeLoadTimeout:G,onStylesheetLoad:z,stylesheetLoadTimeout:L,keepIframeSrcFn:D,newlyAddedElement:!1})}var hr=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function ci(e,t){t===void 0&&(t={});var r=1,n=1;function i(S){var C=S.match(/\n/g);C&&(r+=C.length);var E=S.lastIndexOf(`
`);n=E===-1?n+S.length:S.length-E}function s(){var S={line:r,column:n};return function(C){return C.position=new a(S),p(),C}}var a=function(){function S(C){this.start=C,this.end={line:r,column:n},this.source=t.source}return S}();a.prototype.content=e;var l=[];function o(S){var C=new Error("".concat(t.source||"",":").concat(r,":").concat(n,": ").concat(S));if(C.reason=S,C.filename=t.source,C.line=r,C.column=n,C.source=e,t.silent)l.push(C);else throw C}function c(){var S=f();return{type:"stylesheet",stylesheet:{source:t.source,rules:S,parsingErrors:l}}}function u(){return h(/^{\s*/)}function d(){return h(/^}/)}function f(){var S,C=[];for(p(),m(C);e.length&&e.charAt(0)!=="}"&&(S=D()||Z());)S&&(C.push(S),m(C));return C}function h(S){var C=S.exec(e);if(C){var E=C[0];return i(E),e=e.slice(E.length),C}}function p(){h(/^\s*/)}function m(S){S===void 0&&(S=[]);for(var C;C=I();)C&&S.push(C),C=I();return S}function I(){var S=s();if(!(e.charAt(0)!=="/"||e.charAt(1)!=="*")){for(var C=2;e.charAt(C)!==""&&(e.charAt(C)!=="*"||e.charAt(C+1)!=="/");)++C;if(C+=2,e.charAt(C-1)==="")return o("End of comment missing");var E=e.slice(2,C-2);return n+=2,i(E),e=e.slice(C),n+=2,S({type:"comment",comment:E})}}function y(){var S=h(/^([^{]+)/);if(S)return Ce(S[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(C){return C.replace(/,/g,"â€Œ")}).split(/\s*(?![^(]*\)),\s*/).map(function(C){return C.replace(/\u200C/g,",")})}function v(){var S=s(),C=h(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(C){var E=Ce(C[0]);if(!h(/^:\s*/))return o("property missing ':'");var M=h(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),H=S({type:"declaration",property:E.replace(hr,""),value:M?Ce(M[0]).replace(hr,""):""});return h(/^[;\s]*/),H}}function g(){var S=[];if(!u())return o("missing '{'");m(S);for(var C;C=v();)C!==!1&&(S.push(C),m(S)),C=v();return d()?S:o("missing '}'")}function b(){for(var S,C=[],E=s();S=h(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)C.push(S[1]),h(/^,\s*/);if(C.length)return E({type:"keyframe",values:C,declarations:g()})}function N(){var S=s(),C=h(/^@([-\w]+)?keyframes\s*/);if(C){var E=C[1];if(C=h(/^([-\w]+)\s*/),!C)return o("@keyframes missing name");var M=C[1];if(!u())return o("@keyframes missing '{'");for(var H,J=m();H=b();)J.push(H),J=J.concat(m());return d()?S({type:"keyframes",name:M,vendor:E,keyframes:J}):o("@keyframes missing '}'")}}function T(){var S=s(),C=h(/^@supports *([^{]+)/);if(C){var E=Ce(C[1]);if(!u())return o("@supports missing '{'");var M=m().concat(f());return d()?S({type:"supports",supports:E,rules:M}):o("@supports missing '}'")}}function k(){var S=s(),C=h(/^@host\s*/);if(C){if(!u())return o("@host missing '{'");var E=m().concat(f());return d()?S({type:"host",rules:E}):o("@host missing '}'")}}function A(){var S=s(),C=h(/^@media *([^{]+)/);if(C){var E=Ce(C[1]);if(!u())return o("@media missing '{'");var M=m().concat(f());return d()?S({type:"media",media:E,rules:M}):o("@media missing '}'")}}function K(){var S=s(),C=h(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(C)return S({type:"custom-media",name:Ce(C[1]),media:Ce(C[2])})}function _(){var S=s(),C=h(/^@page */);if(C){var E=y()||[];if(!u())return o("@page missing '{'");for(var M=m(),H;H=v();)M.push(H),M=M.concat(m());return d()?S({type:"page",selectors:E,declarations:M}):o("@page missing '}'")}}function j(){var S=s(),C=h(/^@([-\w]+)?document *([^{]+)/);if(C){var E=Ce(C[1]),M=Ce(C[2]);if(!u())return o("@document missing '{'");var H=m().concat(f());return d()?S({type:"document",document:M,vendor:E,rules:H}):o("@document missing '}'")}}function U(){var S=s(),C=h(/^@font-face\s*/);if(C){if(!u())return o("@font-face missing '{'");for(var E=m(),M;M=v();)E.push(M),E=E.concat(m());return d()?S({type:"font-face",declarations:E}):o("@font-face missing '}'")}}var G=F("import"),z=F("charset"),L=F("namespace");function F(S){var C=new RegExp("^@"+S+"\\s*([^;]+);");return function(){var E=s(),M=h(C);if(M){var H={type:S};return H[S]=M[1].trim(),E(H)}}}function D(){if(e[0]==="@")return N()||A()||K()||T()||G()||z()||L()||j()||_()||k()||U()}function Z(){var S=s(),C=y();return C?(m(),S({type:"rule",selectors:C,declarations:g()})):o("selector missing")}return Lt(c())}function Ce(e){return e?e.replace(/^\s+|\s+$/g,""):""}function Lt(e,t){for(var r=e&&typeof e.type=="string",n=r?e:t,i=0,s=Object.keys(e);i<s.length;i++){var a=s[i],l=e[a];Array.isArray(l)?l.forEach(function(o){Lt(o,n)}):l&&typeof l=="object"&&Lt(l,n)}return r&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),e}var pr={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function ui(e){var t=pr[e.tagName]?pr[e.tagName]:e.tagName;return t==="link"&&e.attributes._cssText&&(t="style"),t}function di(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Jr=/([^\\]):hover/,fi=new RegExp(Jr.source,"g");function mr(e,t){var r=t==null?void 0:t.stylesWithHoverClass.get(e);if(r)return r;var n=ci(e,{silent:!0});if(!n.stylesheet)return e;var i=[];if(n.stylesheet.rules.forEach(function(l){"selectors"in l&&(l.selectors||[]).forEach(function(o){Jr.test(o)&&i.push(o)})}),i.length===0)return e;var s=new RegExp(i.filter(function(l,o){return i.indexOf(l)===o}).sort(function(l,o){return o.length-l.length}).map(function(l){return di(l)}).join("|"),"g"),a=e.replace(s,function(l){var o=l.replace(fi,"$1.\\:hover");return"".concat(l,", ").concat(o)});return t==null||t.stylesWithHoverClass.set(e,a),a}function gr(){var e=new Map;return{stylesWithHoverClass:e}}function hi(e,t){var r=t.doc,n=t.hackCss,i=t.cache;switch(e.type){case x.Document:return r.implementation.createDocument(null,"",null);case x.DocumentType:return r.implementation.createDocumentType(e.name||"html",e.publicId,e.systemId);case x.Element:{var s=ui(e),a;e.isSVG?a=r.createElementNS("http://www.w3.org/2000/svg",s):a=r.createElement(s);var l={};for(var o in e.attributes)if(Object.prototype.hasOwnProperty.call(e.attributes,o)){var c=e.attributes[o];if(!(s==="option"&&o==="selected"&&c===!1)&&c!==null){if(c===!0&&(c=""),o.startsWith("rr_")){l[o]=c;continue}var u=s==="textarea"&&o==="value",d=s==="style"&&o==="_cssText";if(d&&n&&typeof c=="string"&&(c=mr(c,i)),(u||d)&&typeof c=="string"){for(var f=r.createTextNode(c),h=0,p=Array.from(a.childNodes);h<p.length;h++){var m=p[h];m.nodeType===a.TEXT_NODE&&a.removeChild(m)}a.appendChild(f);continue}try{if(e.isSVG&&o==="xlink:href")a.setAttributeNS("http://www.w3.org/1999/xlink",o,c.toString());else if(o==="onload"||o==="onclick"||o.substring(0,7)==="onmouse")a.setAttribute("_"+o,c.toString());else if(s==="meta"&&e.attributes["http-equiv"]==="Content-Security-Policy"&&o==="content"){a.setAttribute("csp-content",c.toString());continue}else s==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||s==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")||(s==="img"&&e.attributes.srcset&&e.attributes.rr_dataURL?a.setAttribute("rrweb-original-srcset",e.attributes.srcset):a.setAttribute(o,c.toString()))}catch{}}}var I=function(v){var g=l[v];if(s==="canvas"&&v==="rr_dataURL"){var b=document.createElement("img");b.onload=function(){var T=a.getContext("2d");T&&T.drawImage(b,0,0,b.width,b.height)},b.src=g.toString(),a.RRNodeType&&(a.rr_dataURL=g.toString())}else if(s==="img"&&v==="rr_dataURL"){var N=a;N.currentSrc.startsWith("data:")||(N.setAttribute("rrweb-original-src",e.attributes.src),N.src=g.toString())}if(v==="rr_width")a.style.width=g.toString();else if(v==="rr_height")a.style.height=g.toString();else if(v==="rr_mediaCurrentTime"&&typeof g=="number")a.currentTime=g;else if(v==="rr_mediaState")switch(g){case"played":a.play().catch(function(T){return console.warn("media playback error",T)});break;case"paused":a.pause();break}};for(var y in l)I(y);if(e.isShadowHost)if(!a.shadowRoot)a.attachShadow({mode:"open"});else for(;a.shadowRoot.firstChild;)a.shadowRoot.removeChild(a.shadowRoot.firstChild);return a}case x.Text:return r.createTextNode(e.isStyle&&n?mr(e.textContent,i):e.textContent);case x.CDATA:return r.createCDATASection(e.textContent);case x.Comment:return r.createComment(e.textContent);default:return null}}function qe(e,t){var r=t.doc,n=t.mirror,i=t.skipChild,s=i===void 0?!1:i,a=t.hackCss,l=a===void 0?!0:a,o=t.afterAppend,c=t.cache;if(n.has(e.id)){var u=n.getNode(e.id),d=n.getMeta(u);if(Pn(d,e))return n.getNode(e.id)}var f=hi(e,{doc:r,hackCss:l,cache:c});if(!f)return null;if(e.rootId&&n.getNode(e.rootId)!==r&&n.replace(e.rootId,r),e.type===x.Document&&(r.close(),r.open(),e.compatMode==="BackCompat"&&e.childNodes&&e.childNodes[0].type!==x.DocumentType&&(e.childNodes[0].type===x.Element&&"xmlns"in e.childNodes[0].attributes&&e.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),f=r),n.add(f,e),(e.type===x.Document||e.type===x.Element)&&!s)for(var h=function(y){var v=qe(y,{doc:r,mirror:n,skipChild:!1,hackCss:l,afterAppend:o,cache:c});if(!v)return console.warn("Failed to rebuild",y),"continue";if(y.isShadow&&Zr(f)&&f.shadowRoot)f.shadowRoot.appendChild(v);else if(e.type===x.Document&&y.type==x.Element){var g=v,b=null;g.childNodes.forEach(function(N){N.nodeName==="BODY"&&(b=N)}),b?(g.removeChild(b),f.appendChild(v),g.appendChild(b)):f.appendChild(v)}else f.appendChild(v);o&&o(v,y.id)},p=0,m=e.childNodes;p<m.length;p++){var I=m[p];h(I)}return f}function pi(e,t){function r(a){t(a)}for(var n=0,i=e.getIds();n<i.length;n++){var s=i[n];e.has(s)&&r(e.getNode(s))}}function mi(e,t){var r=t.getMeta(e);if((r==null?void 0:r.type)===x.Element){var n=e;for(var i in r.attributes)if(Object.prototype.hasOwnProperty.call(r.attributes,i)&&i.startsWith("rr_")){var s=r.attributes[i];i==="rr_scrollLeft"&&(n.scrollLeft=s),i==="rr_scrollTop"&&(n.scrollTop=s)}}}function gi(e,t){var r=t.doc,n=t.onVisit,i=t.hackCss,s=i===void 0?!0:i,a=t.afterAppend,l=t.cache,o=t.mirror,c=o===void 0?new zt:o,u=qe(e,{doc:r,mirror:c,skipChild:!1,hackCss:s,afterAppend:a,cache:l});return pi(c,function(d){n&&n(d),mi(d,c)}),u}function le(e,t,r=document){const n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}const Fe=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let Ft={map:{},getId(){return console.error(Fe),-1},getNode(){return console.error(Fe),null},removeNodeFromMap(){console.error(Fe)},has(){return console.error(Fe),!1},reset(){console.error(Fe)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(Ft=new Proxy(Ft,{get(e,t,r){return t==="map"&&console.error(Fe),Reflect.get(e,t,r)}}));function He(e,t,r={}){let n=null,i=0;return function(...s){const a=Date.now();!i&&r.leading===!1&&(i=a);const l=t-(a-i),o=this;l<=0||l>t?(n&&(clearTimeout(n),n=null),i=a,e.apply(o,s)):!n&&r.trailing!==!1&&(n=setTimeout(()=>{i=r.leading===!1?0:Date.now(),n=null,e.apply(o,s)},l))}}function it(e,t,r,n,i=window){const s=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,n?r:{set(a){setTimeout(()=>{r.set.call(this,a)},0),s&&s.set&&s.set.call(this,a)}}),()=>it(e,t,s||{},!0)}function ke(e,t,r){try{if(!(t in e))return()=>{};const n=e[t],i=r(n);return typeof i=="function"&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:n}})),e[t]=i,()=>{e[t]=n}}catch{return()=>{}}}let tt=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(tt=()=>new Date().getTime());function Jt(e){var t,r,n,i,s,a;const l=e.document;return{left:l.scrollingElement?l.scrollingElement.scrollLeft:e.pageXOffset!==void 0?e.pageXOffset:(l==null?void 0:l.documentElement.scrollLeft)||((r=(t=l==null?void 0:l.body)===null||t===void 0?void 0:t.parentElement)===null||r===void 0?void 0:r.scrollLeft)||((n=l==null?void 0:l.body)===null||n===void 0?void 0:n.scrollLeft)||0,top:l.scrollingElement?l.scrollingElement.scrollTop:e.pageYOffset!==void 0?e.pageYOffset:(l==null?void 0:l.documentElement.scrollTop)||((s=(i=l==null?void 0:l.body)===null||i===void 0?void 0:i.parentElement)===null||s===void 0?void 0:s.scrollTop)||((a=l==null?void 0:l.body)===null||a===void 0?void 0:a.scrollTop)||0}}function Qt(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function qt(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function ce(e,t,r,n){if(!e)return!1;const i=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!i)return!1;try{if(typeof t=="string"){if(i.classList.contains(t)||n&&i.closest("."+t)!==null)return!0}else if(vt(i,t,n))return!0}catch{}return!!(r&&(i.matches(r)||n&&i.closest(r)!==null))}function Qr(e,t){return t.getId(e)!==-1}function dt(e,t){return t.getId(e)===et}function $t(e,t){if(Je(e))return!1;const r=t.getId(e);return t.has(r)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?$t(e.parentNode,t):!0:!0}function yt(e){return!!e.changedTouches}function er(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let r=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===r)return!0;while(r=r&&r.parentNode);return!1})}function qr(e){const t={},r=(i,s)=>{const a={value:i,parent:s,children:[]};return t[i.node.id]=a,a},n=[];for(const i of e){const{nextId:s,parentId:a}=i;if(s&&s in t){const l=t[s];if(l.parent){const o=l.parent.children.indexOf(l);l.parent.children.splice(o,0,r(i,l.parent))}else{const o=n.indexOf(l);n.splice(o,0,r(i,null))}continue}if(a in t){const l=t[a];l.children.push(r(i,l));continue}n.push(r(i,null))}return n}function tr(e,t){t(e.value);for(let r=e.children.length-1;r>=0;r--)tr(e.children[r],t)}function Ze(e,t){return!!(e.nodeName==="IFRAME"&&t.getMeta(e))}function rr(e,t){return!!(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function nr(e,t){var r,n;const i=(n=(r=e.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||n===void 0?void 0:n.frameElement;if(!i||i===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};const s=i.getBoundingClientRect(),a=nr(i,t),l=s.height/i.clientHeight;return{x:s.x*a.relativeScale+a.x,y:s.y*a.relativeScale+a.y,relativeScale:l,absoluteScale:a.absoluteScale*l}}function Ee(e){return!!(e!=null&&e.shadowRoot)}function Ve(e,t){const r=e[t[0]];return t.length===1?r:Ve(r.cssRules[t[1]].cssRules,t.slice(2))}function _t(e){const t=[...e],r=t.pop();return{positions:t,index:r}}function $r(e){const t=new Set,r=[];for(let n=e.length;n--;){const i=e[n];t.has(i.id)||(r.push(i),t.add(i.id))}return r}class ir{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var r;return(r=this.styleIDMap.get(t))!==null&&r!==void 0?r:-1}has(t){return this.styleIDMap.has(t)}add(t,r){if(this.has(t))return this.getId(t);let n;return r===void 0?n=this.id++:n=r,this.styleIDMap.set(t,n),this.idStyleMap.set(n,t),n}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function sr(e){var t,r;let n=null;return((r=(t=e.getRootNode)===null||t===void 0?void 0:t.call(e))===null||r===void 0?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(n=e.getRootNode().host),n}function en(e){let t=e,r;for(;r=sr(t);)t=r;return t}function tn(e){const t=e.ownerDocument;if(!t)return!1;const r=en(e);return t.contains(r)}function or(e){const t=e.ownerDocument;return t?t.contains(e)||tn(e):!1}const io=Object.freeze(Object.defineProperty({__proto__:null,StyleSheetMirror:ir,get _mirror(){return Ft},getBaseDimension:nr,getNestedRule:Ve,getPositionsAndIndex:_t,getRootShadowHost:en,getShadowHost:sr,getWindowHeight:Qt,getWindowScroll:Jt,getWindowWidth:qt,hasShadowRoot:Ee,hookSetter:it,inDom:or,isAncestorRemoved:$t,isBlocked:ce,isIgnored:dt,isSerialized:Qr,isSerializedIframe:Ze,isSerializedStylesheet:rr,iterateResolveTree:tr,legacy_isTouchEvent:yt,get nowTimestamp(){return tt},on:le,patch:ke,polyfill:er,queueToResolveTrees:qr,shadowHostInDom:tn,throttle:He,uniqueTextMutations:$r},Symbol.toStringTag,{value:"Module"}));var R=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(R||{}),w=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(w||{}),P=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(P||{}),Se=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(Se||{}),Ae=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(Ae||{}),Y=(e=>(e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back",e.Destroy="destroy",e))(Y||{});function vr(e){return"__ln"in e}class vi{constructor(){this.length=0,this.head=null,this.tail=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let n=0;n<t;n++)r=(r==null?void 0:r.next)||null;return r}addNode(t){const r={value:t,previous:null,next:null};if(t.__ln=r,t.previousSibling&&vr(t.previousSibling)){const n=t.previousSibling.__ln.next;r.next=n,r.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=r,n&&(n.previous=r)}else if(t.nextSibling&&vr(t.nextSibling)&&t.nextSibling.__ln.previous){const n=t.nextSibling.__ln.previous;r.previous=n,r.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=r,n&&(n.next=r)}else this.head&&(this.head.previous=r),r.next=this.head,this.head=r;r.next===null&&(this.tail=r),this.length++}removeNode(t){const r=t.__ln;this.head&&(r.previous?(r.previous.next=r.next,r.next?r.next.previous=r.previous:this.tail=r.previous):(this.head=r.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}const yr=(e,t)=>`${e}@${t}`;class yi{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],r=new Set,n=new vi,i=o=>{let c=o,u=et;for(;u===et;)c=c&&c.nextSibling,u=c&&this.mirror.getId(c);return u},s=o=>{if(!o.parentNode||!or(o))return;const c=Je(o.parentNode)?this.mirror.getId(sr(o)):this.mirror.getId(o.parentNode),u=i(o);if(c===-1||u===-1)return n.addNode(o);const d=Ue(o,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:f=>{Ze(f,this.mirror)&&this.iframeManager.addIframe(f),rr(f,this.mirror)&&this.stylesheetManager.trackLinkElement(f),Ee(o)&&this.shadowDomManager.addShadowRoot(o.shadowRoot,this.doc)},onIframeLoad:(f,h)=>{this.iframeManager.attachIframe(f,h),this.shadowDomManager.observeAttachShadow(f)},onStylesheetLoad:(f,h)=>{this.stylesheetManager.attachLinkElement(f,h)}});d&&(t.push({parentId:c,nextId:u,node:d}),r.add(d.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const o of this.movedSet)Cr(this.removes,o,this.mirror)&&!this.movedSet.has(o.parentNode)||s(o);for(const o of this.addedSet)!Ir(this.droppedSet,o)&&!Cr(this.removes,o,this.mirror)||Ir(this.movedSet,o)?s(o):this.droppedSet.add(o);let a=null;for(;n.length;){let o=null;if(a){const c=this.mirror.getId(a.value.parentNode),u=i(a.value);c!==-1&&u!==-1&&(o=a)}if(!o){let c=n.tail;for(;c;){const u=c;if(c=c.previous,u){const d=this.mirror.getId(u.value.parentNode);if(i(u.value)===-1)continue;if(d!==-1){o=u;break}else{const h=u.value;if(h.parentNode&&h.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const p=h.parentNode.host;if(this.mirror.getId(p)!==-1){o=u;break}}}}}}if(!o){for(;n.head;)n.removeNode(n.head.value);break}a=o.previous,n.removeNode(o.value),s(o.value)}const l={texts:this.texts.map(o=>({id:this.mirror.getId(o.node),value:o.value})).filter(o=>!r.has(o.id)).filter(o=>this.mirror.has(o.id)),attributes:this.attributes.map(o=>{const{attributes:c}=o;if(typeof c.style=="string"){const u=JSON.stringify(o.styleDiff),d=JSON.stringify(o._unchangedStyles);u.length<c.style.length&&(u+d).split("var(").length===c.style.split("var(").length&&(c.style=o.styleDiff)}return{id:this.mirror.getId(o.node),attributes:c}}).filter(o=>!r.has(o.id)).filter(o=>this.mirror.has(o.id)),removes:this.removes,adds:t};!l.texts.length&&!l.attributes.length&&!l.removes.length&&!l.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(l))},this.processMutation=t=>{if(dt(t.target,this.mirror))return;let r;try{r=document.implementation.createHTMLDocument()}catch{r=this.doc}switch(t.type){case"characterData":{const n=t.target.textContent;!ce(t.target,this.blockClass,this.blockSelector,!1)&&n!==t.oldValue&&this.texts.push({value:Xr(t.target,this.maskTextClass,this.maskTextSelector)&&n?this.maskTextFn?this.maskTextFn(n):n.replace(/[\S]/g,"*"):n,node:t.target});break}case"attributes":{const n=t.target;let i=t.attributeName,s=t.target.getAttribute(i);if(i==="value"){const l=jt(n);s=Kt({element:n,maskInputOptions:this.maskInputOptions,tagName:n.tagName,type:l,value:s,maskInputFn:this.maskInputFn})}if(ce(t.target,this.blockClass,this.blockSelector,!1)||s===t.oldValue)return;let a=this.attributes.find(l=>l.node===t.target);if(n.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(s))if(!n.contentDocument)i="rr_src";else return;if(a||(a={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(a)),i==="type"&&n.tagName==="INPUT"&&(t.oldValue||"").toLowerCase()==="password"&&n.setAttribute("data-rr-is-password","true"),!jr(n.tagName,i)&&(a.attributes[i]=Kr(this.doc,Me(n.tagName),Me(i),s),i==="style")){const l=r.createElement("span");t.oldValue&&l.setAttribute("style",t.oldValue);for(const o of Array.from(n.style)){const c=n.style.getPropertyValue(o),u=n.style.getPropertyPriority(o);c!==l.style.getPropertyValue(o)||u!==l.style.getPropertyPriority(o)?u===""?a.styleDiff[o]=c:a.styleDiff[o]=[c,u]:a._unchangedStyles[o]=[c,u]}for(const o of Array.from(l.style))n.style.getPropertyValue(o)===""&&(a.styleDiff[o]=!1)}break}case"childList":{if(ce(t.target,this.blockClass,this.blockSelector,!0))return;t.addedNodes.forEach(n=>this.genAdds(n,t.target)),t.removedNodes.forEach(n=>{const i=this.mirror.getId(n),s=Je(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);ce(t.target,this.blockClass,this.blockSelector,!1)||dt(n,this.mirror)||!Qr(n,this.mirror)||(this.addedSet.has(n)?(Bt(this.addedSet,n),this.droppedSet.add(n)):this.addedSet.has(t.target)&&i===-1||$t(t.target,this.mirror)||(this.movedSet.has(n)&&this.movedMap[yr(i,s)]?Bt(this.movedSet,n):this.removes.push({parentId:s,id:i,isShadow:Je(t.target)&&Qe(t.target)?!0:void 0})),this.mapRemoves.push(n))});break}}},this.genAdds=(t,r)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!(this.addedSet.has(t)||this.movedSet.has(t))){if(this.mirror.hasNode(t)){if(dt(t,this.mirror))return;this.movedSet.add(t);let n=null;r&&this.mirror.hasNode(r)&&(n=this.mirror.getId(r)),n&&n!==-1&&(this.movedMap[yr(this.mirror.getId(t),n)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);ce(t,this.blockClass,this.blockSelector,!1)||(t.childNodes.forEach(n=>this.genAdds(n)),Ee(t)&&t.shadowRoot.childNodes.forEach(n=>{this.processedNodeManager.add(n,this),this.genAdds(n,t)}))}}}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(r=>{this[r]=t[r]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Bt(e,t){e.delete(t),t.childNodes.forEach(r=>Bt(e,r))}function Cr(e,t,r){return e.length===0?!1:rn(e,t,r)}function rn(e,t,r){const{parentNode:n}=t;if(!n)return!1;const i=r.getId(n);return e.some(s=>s.id===i)?!0:rn(e,n,r)}function Ir(e,t){return e.size===0?!1:nn(e,t)}function nn(e,t){const{parentNode:r}=t;return r?e.has(r)?!0:nn(e,r):!1}let $e;function Ci(e){$e=e}function Ii(){$e=void 0}const W=e=>$e?(...r)=>{try{return e(...r)}catch(n){if($e&&$e(n)===!0)return;throw n}}:e,De=[];function st(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function sn(e,t){var r,n;const i=new yi;De.push(i),i.init(e);let s=window.MutationObserver||window.__rrMutationObserver;const a=(n=(r=window==null?void 0:window.Zone)===null||r===void 0?void 0:r.__symbol__)===null||n===void 0?void 0:n.call(r,"MutationObserver");a&&window[a]&&(s=window[a]);const l=new s(W(i.processMutations.bind(i)));return l.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),l}function Si({mousemoveCb:e,sampling:t,doc:r,mirror:n}){if(t.mousemove===!1)return()=>{};const i=typeof t.mousemove=="number"?t.mousemove:50,s=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let a=[],l;const o=He(W(d=>{const f=Date.now()-l;e(a.map(h=>(h.timeOffset-=f,h)),d),a=[],l=null}),s),c=W(He(W(d=>{const f=st(d),{clientX:h,clientY:p}=yt(d)?d.changedTouches[0]:d;l||(l=tt()),a.push({x:h,y:p,id:n.getId(f),timeOffset:tt()-l}),o(typeof DragEvent<"u"&&d instanceof DragEvent?w.Drag:d instanceof MouseEvent?w.MouseMove:w.TouchMove)}),i,{trailing:!1})),u=[le("mousemove",c,r),le("touchmove",c,r),le("drag",c,r)];return W(()=>{u.forEach(d=>d())})}function bi({mouseInteractionCb:e,doc:t,mirror:r,blockClass:n,blockSelector:i,sampling:s}){if(s.mouseInteraction===!1)return()=>{};const a=s.mouseInteraction===!0||s.mouseInteraction===void 0?{}:s.mouseInteraction,l=[];let o=null;const c=u=>d=>{const f=st(d);if(ce(f,n,i,!0))return;let h=null,p=u;if("pointerType"in d){switch(d.pointerType){case"mouse":h=Se.Mouse;break;case"touch":h=Se.Touch;break;case"pen":h=Se.Pen;break}h===Se.Touch?P[u]===P.MouseDown?p="TouchStart":P[u]===P.MouseUp&&(p="TouchEnd"):Se.Pen}else yt(d)&&(h=Se.Touch);h!==null?(o=h,(p.startsWith("Touch")&&h===Se.Touch||p.startsWith("Mouse")&&h===Se.Mouse)&&(h=null)):P[u]===P.Click&&(h=o,o=null);const m=yt(d)?d.changedTouches[0]:d;if(!m)return;const I=r.getId(f),{clientX:y,clientY:v}=m;W(e)(Object.assign({type:P[p],id:I,x:y,y:v},h!==null&&{pointerType:h}))};return Object.keys(P).filter(u=>Number.isNaN(Number(u))&&!u.endsWith("_Departed")&&a[u]!==!1).forEach(u=>{let d=Me(u);const f=c(u);if(window.PointerEvent)switch(P[u]){case P.MouseDown:case P.MouseUp:d=d.replace("mouse","pointer");break;case P.TouchStart:case P.TouchEnd:return}l.push(le(d,f,t))}),W(()=>{l.forEach(u=>u())})}function on({scrollCb:e,doc:t,mirror:r,blockClass:n,blockSelector:i,sampling:s}){const a=W(He(W(l=>{const o=st(l);if(!o||ce(o,n,i,!0))return;const c=r.getId(o);if(o===t&&t.defaultView){const u=Jt(t.defaultView);e({id:c,x:u.left,y:u.top})}else e({id:c,x:o.scrollLeft,y:o.scrollTop})}),s.scroll||100));return le("scroll",a,t)}function Ai({viewportResizeCb:e},{win:t}){let r=-1,n=-1;const i=W(He(W(()=>{const s=Qt(),a=qt();(r!==s||n!==a)&&(e({width:Number(a),height:Number(s)}),r=s,n=a)}),200));return le("resize",i,t)}function Sr(e,t){const r=Object.assign({},e);return t||delete r.userTriggered,r}const Ni=["INPUT","TEXTAREA","SELECT"],br=new WeakMap;function wi({inputCb:e,doc:t,mirror:r,blockClass:n,blockSelector:i,ignoreClass:s,ignoreSelector:a,maskInputOptions:l,maskInputFn:o,sampling:c,userTriggeredOnInput:u}){function d(v){let g=st(v);const b=v.isTrusted,N=g&&g.tagName;if(g&&N==="OPTION"&&(g=g.parentElement),!g||!N||Ni.indexOf(N)<0||ce(g,n,i,!0)||g.classList.contains(s)||a&&g.matches(a))return;let T=g.value,k=!1;const A=jt(g)||"";A==="radio"||A==="checkbox"?k=g.checked:(l[N.toLowerCase()]||l[A])&&(T=Kt({element:g,maskInputOptions:l,tagName:N,type:A,value:T,maskInputFn:o})),f(g,W(Sr)({text:T,isChecked:k,userTriggered:b},u));const K=g.name;A==="radio"&&K&&k&&t.querySelectorAll(`input[type="radio"][name="${K}"]`).forEach(_=>{_!==g&&f(_,W(Sr)({text:_.value,isChecked:!k,userTriggered:!1},u))})}function f(v,g){const b=br.get(v);if(!b||b.text!==g.text||b.isChecked!==g.isChecked){br.set(v,g);const N=r.getId(v);W(e)(Object.assign(Object.assign({},g),{id:N}))}}const p=(c.input==="last"?["change"]:["input","change"]).map(v=>le(v,W(d),t)),m=t.defaultView;if(!m)return()=>{p.forEach(v=>v())};const I=m.Object.getOwnPropertyDescriptor(m.HTMLInputElement.prototype,"value"),y=[[m.HTMLInputElement.prototype,"value"],[m.HTMLInputElement.prototype,"checked"],[m.HTMLSelectElement.prototype,"value"],[m.HTMLTextAreaElement.prototype,"value"],[m.HTMLSelectElement.prototype,"selectedIndex"],[m.HTMLOptionElement.prototype,"selected"]];return I&&I.set&&p.push(...y.map(v=>it(v[0],v[1],{set(){W(d)({target:this,isTrusted:!1})}},!1,m))),W(()=>{p.forEach(v=>v())})}function Ct(e){const t=[];function r(n,i){if(at("CSSGroupingRule")&&n.parentRule instanceof CSSGroupingRule||at("CSSMediaRule")&&n.parentRule instanceof CSSMediaRule||at("CSSSupportsRule")&&n.parentRule instanceof CSSSupportsRule||at("CSSConditionRule")&&n.parentRule instanceof CSSConditionRule){const a=Array.from(n.parentRule.cssRules).indexOf(n);i.unshift(a)}else if(n.parentStyleSheet){const a=Array.from(n.parentStyleSheet.cssRules).indexOf(n);i.unshift(a)}return i}return r(e,t)}function we(e,t,r){let n,i;return e?(e.ownerNode?n=t.getId(e.ownerNode):i=r.getId(e),{styleId:i,id:n}):{}}function Ei({styleSheetRuleCb:e,mirror:t,stylesheetManager:r},{win:n}){if(!n.CSSStyleSheet||!n.CSSStyleSheet.prototype)return()=>{};const i=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:W((u,d,f)=>{const[h,p]=f,{id:m,styleId:I}=we(d,t,r.styleMirror);return(m&&m!==-1||I&&I!==-1)&&e({id:m,styleId:I,adds:[{rule:h,index:p}]}),u.apply(d,f)})});const s=n.CSSStyleSheet.prototype.deleteRule;n.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:W((u,d,f)=>{const[h]=f,{id:p,styleId:m}=we(d,t,r.styleMirror);return(p&&p!==-1||m&&m!==-1)&&e({id:p,styleId:m,removes:[{index:h}]}),u.apply(d,f)})});let a;n.CSSStyleSheet.prototype.replace&&(a=n.CSSStyleSheet.prototype.replace,n.CSSStyleSheet.prototype.replace=new Proxy(a,{apply:W((u,d,f)=>{const[h]=f,{id:p,styleId:m}=we(d,t,r.styleMirror);return(p&&p!==-1||m&&m!==-1)&&e({id:p,styleId:m,replace:h}),u.apply(d,f)})}));let l;n.CSSStyleSheet.prototype.replaceSync&&(l=n.CSSStyleSheet.prototype.replaceSync,n.CSSStyleSheet.prototype.replaceSync=new Proxy(l,{apply:W((u,d,f)=>{const[h]=f,{id:p,styleId:m}=we(d,t,r.styleMirror);return(p&&p!==-1||m&&m!==-1)&&e({id:p,styleId:m,replaceSync:h}),u.apply(d,f)})}));const o={};lt("CSSGroupingRule")?o.CSSGroupingRule=n.CSSGroupingRule:(lt("CSSMediaRule")&&(o.CSSMediaRule=n.CSSMediaRule),lt("CSSConditionRule")&&(o.CSSConditionRule=n.CSSConditionRule),lt("CSSSupportsRule")&&(o.CSSSupportsRule=n.CSSSupportsRule));const c={};return Object.entries(o).forEach(([u,d])=>{c[u]={insertRule:d.prototype.insertRule,deleteRule:d.prototype.deleteRule},d.prototype.insertRule=new Proxy(c[u].insertRule,{apply:W((f,h,p)=>{const[m,I]=p,{id:y,styleId:v}=we(h.parentStyleSheet,t,r.styleMirror);return(y&&y!==-1||v&&v!==-1)&&e({id:y,styleId:v,adds:[{rule:m,index:[...Ct(h),I||0]}]}),f.apply(h,p)})}),d.prototype.deleteRule=new Proxy(c[u].deleteRule,{apply:W((f,h,p)=>{const[m]=p,{id:I,styleId:y}=we(h.parentStyleSheet,t,r.styleMirror);return(I&&I!==-1||y&&y!==-1)&&e({id:I,styleId:y,removes:[{index:[...Ct(h),m]}]}),f.apply(h,p)})})}),W(()=>{n.CSSStyleSheet.prototype.insertRule=i,n.CSSStyleSheet.prototype.deleteRule=s,a&&(n.CSSStyleSheet.prototype.replace=a),l&&(n.CSSStyleSheet.prototype.replaceSync=l),Object.entries(o).forEach(([u,d])=>{d.prototype.insertRule=c[u].insertRule,d.prototype.deleteRule=c[u].deleteRule})})}function an({mirror:e,stylesheetManager:t},r){var n,i,s;let a=null;r.nodeName==="#document"?a=e.getId(r):a=e.getId(r.host);const l=r.nodeName==="#document"?(n=r.defaultView)===null||n===void 0?void 0:n.Document:(s=(i=r.ownerDocument)===null||i===void 0?void 0:i.defaultView)===null||s===void 0?void 0:s.ShadowRoot,o=Object.getOwnPropertyDescriptor(l==null?void 0:l.prototype,"adoptedStyleSheets");return a===null||a===-1||!l||!o?()=>{}:(Object.defineProperty(r,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get(){var c;return(c=o.get)===null||c===void 0?void 0:c.call(this)},set(c){var u;const d=(u=o.set)===null||u===void 0?void 0:u.call(this,c);if(a!==null&&a!==-1)try{t.adoptStyleSheets(c,a)}catch{}return d}}),W(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:o.configurable,enumerable:o.enumerable,get:o.get,set:o.set})}))}function Ti({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:r,stylesheetManager:n},{win:i}){const s=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:W((l,o,c)=>{var u;const[d,f,h]=c;if(r.has(d))return s.apply(o,[d,f,h]);const{id:p,styleId:m}=we((u=o.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,t,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&e({id:p,styleId:m,set:{property:d,value:f,priority:h},index:Ct(o.parentRule)}),l.apply(o,c)})});const a=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(a,{apply:W((l,o,c)=>{var u;const[d]=c;if(r.has(d))return a.apply(o,[d]);const{id:f,styleId:h}=we((u=o.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,t,n.styleMirror);return(f&&f!==-1||h&&h!==-1)&&e({id:f,styleId:h,remove:{property:d},index:Ct(o.parentRule)}),l.apply(o,c)})}),W(()=>{i.CSSStyleDeclaration.prototype.setProperty=s,i.CSSStyleDeclaration.prototype.removeProperty=a})}function Mi({mediaInteractionCb:e,blockClass:t,blockSelector:r,mirror:n,sampling:i,doc:s}){const a=W(o=>He(W(c=>{const u=st(c);if(!u||ce(u,t,r,!0))return;const{currentTime:d,volume:f,muted:h,playbackRate:p}=u;e({type:o,id:n.getId(u),currentTime:d,volume:f,muted:h,playbackRate:p})}),i.media||500)),l=[le("play",a(0),s),le("pause",a(1),s),le("seeked",a(2),s),le("volumechange",a(3),s),le("ratechange",a(4),s)];return W(()=>{l.forEach(o=>o())})}function Ri({fontCb:e,doc:t}){const r=t.defaultView;if(!r)return()=>{};const n=[],i=new WeakMap,s=r.FontFace;r.FontFace=function(o,c,u){const d=new s(o,c,u);return i.set(d,{family:o,buffer:typeof c!="string",descriptors:u,fontSource:typeof c=="string"?c:JSON.stringify(Array.from(new Uint8Array(c)))}),d};const a=ke(t.fonts,"add",function(l){return function(o){return setTimeout(W(()=>{const c=i.get(o);c&&(e(c),i.delete(o))}),0),l.apply(this,[o])}});return n.push(()=>{r.FontFace=s}),n.push(a),W(()=>{n.forEach(l=>l())})}function Di(e){const{doc:t,mirror:r,blockClass:n,blockSelector:i,selectionCb:s}=e;let a=!0;const l=W(()=>{const o=t.getSelection();if(!o||a&&(o!=null&&o.isCollapsed))return;a=o.isCollapsed||!1;const c=[],u=o.rangeCount||0;for(let d=0;d<u;d++){const f=o.getRangeAt(d),{startContainer:h,startOffset:p,endContainer:m,endOffset:I}=f;ce(h,n,i,!0)||ce(m,n,i,!0)||c.push({start:r.getId(h),startOffset:p,end:r.getId(m),endOffset:I})}s({ranges:c})});return l(),le("selectionchange",l)}function ki(e,t){const{mutationCb:r,mousemoveCb:n,mouseInteractionCb:i,scrollCb:s,viewportResizeCb:a,inputCb:l,mediaInteractionCb:o,styleSheetRuleCb:c,styleDeclarationCb:u,canvasMutationCb:d,fontCb:f,selectionCb:h}=e;e.mutationCb=(...p)=>{t.mutation&&t.mutation(...p),r(...p)},e.mousemoveCb=(...p)=>{t.mousemove&&t.mousemove(...p),n(...p)},e.mouseInteractionCb=(...p)=>{t.mouseInteraction&&t.mouseInteraction(...p),i(...p)},e.scrollCb=(...p)=>{t.scroll&&t.scroll(...p),s(...p)},e.viewportResizeCb=(...p)=>{t.viewportResize&&t.viewportResize(...p),a(...p)},e.inputCb=(...p)=>{t.input&&t.input(...p),l(...p)},e.mediaInteractionCb=(...p)=>{t.mediaInteaction&&t.mediaInteaction(...p),o(...p)},e.styleSheetRuleCb=(...p)=>{t.styleSheetRule&&t.styleSheetRule(...p),c(...p)},e.styleDeclarationCb=(...p)=>{t.styleDeclaration&&t.styleDeclaration(...p),u(...p)},e.canvasMutationCb=(...p)=>{t.canvasMutation&&t.canvasMutation(...p),d(...p)},e.fontCb=(...p)=>{t.font&&t.font(...p),f(...p)},e.selectionCb=(...p)=>{t.selection&&t.selection(...p),h(...p)}}function Oi(e,t={}){const r=e.doc.defaultView;if(!r)return()=>{};ki(e,t);const n=sn(e,e.doc),i=Si(e),s=bi(e),a=on(e),l=Ai(e,{win:r}),o=wi(e),c=Mi(e),u=Ei(e,{win:r}),d=an(e,e.doc),f=Ti(e,{win:r}),h=e.collectFonts?Ri(e):()=>{},p=Di(e),m=[];for(const I of e.plugins)m.push(I.observer(I.callback,r,I.options));return W(()=>{De.forEach(I=>I.reset()),n.disconnect(),i(),s(),a(),l(),o(),c(),u(),d(),f(),h(),p(),m.forEach(I=>I())})}function at(e){return typeof window[e]<"u"}function lt(e){return!!(typeof window[e]<"u"&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class Ar{constructor(t){this.generateIdFn=t,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(t,r,n,i){const s=n||this.getIdToRemoteIdMap(t),a=i||this.getRemoteIdToIdMap(t);let l=s.get(r);return l||(l=this.generateIdFn(),s.set(r,l),a.set(l,r)),l}getIds(t,r){const n=this.getIdToRemoteIdMap(t),i=this.getRemoteIdToIdMap(t);return r.map(s=>this.getId(t,s,n,i))}getRemoteId(t,r,n){const i=n||this.getRemoteIdToIdMap(t);if(typeof r!="number")return r;const s=i.get(r);return s||-1}getRemoteIds(t,r){const n=this.getRemoteIdToIdMap(t);return r.map(i=>this.getRemoteId(t,i,n))}reset(t){if(!t){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let r=this.iframeIdToRemoteIdMap.get(t);return r||(r=new Map,this.iframeIdToRemoteIdMap.set(t,r)),r}getRemoteIdToIdMap(t){let r=this.iframeRemoteIdToIdMap.get(t);return r||(r=new Map,this.iframeRemoteIdToIdMap.set(t,r)),r}}class xi{constructor(t){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Ar(zr),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Ar(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,r){var n;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:r}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(n=this.loadListener)===null||n===void 0||n.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){const r=t;if(r.data.type!=="rrweb"||r.origin!==r.data.origin||!t.source)return;const i=this.crossOriginIframeMap.get(t.source);if(!i)return;const s=this.transformCrossOriginEvent(i,r.data.event);s&&this.wrappedEmit(s,r.data.isCheckout)}transformCrossOriginEvent(t,r){var n;switch(r.type){case R.FullSnapshot:{this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(r.data.node,t);const i=r.data.node.id;return this.crossOriginIframeRootIdMap.set(t,i),this.patchRootIdOnNode(r.data.node,i),{timestamp:r.timestamp,type:R.IncrementalSnapshot,data:{source:w.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:r.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case R.Meta:case R.Load:case R.DomContentLoaded:return!1;case R.Plugin:return r;case R.Custom:return this.replaceIds(r.data.payload,t,["id","parentId","previousId","nextId"]),r;case R.IncrementalSnapshot:switch(r.data.source){case w.Mutation:return r.data.adds.forEach(i=>{this.replaceIds(i,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(i.node,t);const s=this.crossOriginIframeRootIdMap.get(t);s&&this.patchRootIdOnNode(i.node,s)}),r.data.removes.forEach(i=>{this.replaceIds(i,t,["parentId","id"])}),r.data.attributes.forEach(i=>{this.replaceIds(i,t,["id"])}),r.data.texts.forEach(i=>{this.replaceIds(i,t,["id"])}),r;case w.Drag:case w.TouchMove:case w.MouseMove:return r.data.positions.forEach(i=>{this.replaceIds(i,t,["id"])}),r;case w.ViewportResize:return!1;case w.MediaInteraction:case w.MouseInteraction:case w.Scroll:case w.CanvasMutation:case w.Input:return this.replaceIds(r.data,t,["id"]),r;case w.StyleSheetRule:case w.StyleDeclaration:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleId"]),r;case w.Font:return r;case w.Selection:return r.data.ranges.forEach(i=>{this.replaceIds(i,t,["start","end"])}),r;case w.AdoptedStyleSheet:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleIds"]),(n=r.data.styles)===null||n===void 0||n.forEach(i=>{this.replaceStyleIds(i,t,["styleId"])}),r}}}replace(t,r,n,i){for(const s of i)!Array.isArray(r[s])&&typeof r[s]!="number"||(Array.isArray(r[s])?r[s]=t.getIds(n,r[s]):r[s]=t.getId(n,r[s]));return r}replaceIds(t,r,n){return this.replace(this.crossOriginIframeMirror,t,r,n)}replaceStyleIds(t,r,n){return this.replace(this.crossOriginIframeStyleMirror,t,r,n)}replaceIdOnNode(t,r){this.replaceIds(t,r,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach(n=>{this.replaceIdOnNode(n,r)})}patchRootIdOnNode(t,r){t.type!==x.Document&&!t.rootId&&(t.rootId=r),"childNodes"in t&&t.childNodes.forEach(n=>{this.patchRootIdOnNode(n,r)})}}class Li{constructor(t){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,r){if(!Qe(t)||this.shadowDoms.has(t))return;this.shadowDoms.add(t);const n=sn(Object.assign(Object.assign({},this.bypassOptions),{doc:r,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t);this.restoreHandlers.push(()=>n.disconnect()),this.restoreHandlers.push(on(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))),setTimeout(()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(t.host)),this.restoreHandlers.push(an({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))},0)}observeAttachShadow(t){!t.contentWindow||!t.contentDocument||this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,r){const n=this;this.restoreHandlers.push(ke(t.prototype,"attachShadow",function(i){return function(s){const a=i.call(this,s);return this.shadowRoot&&or(this)&&n.addShadowRoot(this.shadowRoot,r),a}}))}reset(){this.restoreHandlers.forEach(t=>{try{t()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Fi(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function be(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function l(u){try{c(n.next(u))}catch(d){a(d)}}function o(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(l,o)}c((n=n.apply(e,t||[])).next())})}var Pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var ct=0;ct<Pe.length;ct++)Xe[Pe.charCodeAt(ct)]=ct;var _i=function(e){var t=new Uint8Array(e),r,n=t.length,i="";for(r=0;r<n;r+=3)i+=Pe[t[r]>>2],i+=Pe[(t[r]&3)<<4|t[r+1]>>4],i+=Pe[(t[r+1]&15)<<2|t[r+2]>>6],i+=Pe[t[r+2]&63];return n%3===2?i=i.substring(0,i.length-1)+"=":n%3===1&&(i=i.substring(0,i.length-2)+"=="),i},Bi=function(e){var t=e.length*.75,r=e.length,n,i=0,s,a,l,o;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var c=new ArrayBuffer(t),u=new Uint8Array(c);for(n=0;n<r;n+=4)s=Xe[e.charCodeAt(n)],a=Xe[e.charCodeAt(n+1)],l=Xe[e.charCodeAt(n+2)],o=Xe[e.charCodeAt(n+3)],u[i++]=s<<2|a>>4,u[i++]=(a&15)<<4|l>>2,u[i++]=(l&3)<<6|o&63;return c};const Nr=new Map;function Wi(e,t){let r=Nr.get(e);return r||(r=new Map,Nr.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}const ln=(e,t,r)=>{if(!e||!(un(e,t)||typeof e=="object"))return;const n=e.constructor.name,i=Wi(r,n);let s=i.indexOf(e);return s===-1&&(s=i.length,i.push(e)),s};function ft(e,t,r){if(e instanceof Array)return e.map(n=>ft(n,t,r));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const n=e.constructor.name,i=_i(e);return{rr_type:n,base64:i}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[ft(e.buffer,t,r),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const n=e.constructor.name,{src:i}=e;return{rr_type:n,src:i}}else if(e instanceof HTMLCanvasElement){const n="HTMLImageElement",i=e.toDataURL();return{rr_type:n,src:i}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[ft(e.data,t,r),e.width,e.height]};if(un(e,t)||typeof e=="object"){const n=e.constructor.name,i=ln(e,t,r);return{rr_type:n,index:i}}}}return e}const cn=(e,t,r)=>[...e].map(n=>ft(n,t,r)),un=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(i=>typeof t[i]=="function").find(i=>e instanceof t[i]);function Ui(e,t,r,n){const i=[],s=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const a of s)try{if(typeof t.CanvasRenderingContext2D.prototype[a]!="function")continue;const l=ke(t.CanvasRenderingContext2D.prototype,a,function(o){return function(...c){return ce(this.canvas,r,n,!0)||setTimeout(()=>{const u=cn([...c],t,this);e(this.canvas,{type:Ae["2D"],property:a,args:u})},0),o.apply(this,c)}});i.push(l)}catch{const o=it(t.CanvasRenderingContext2D.prototype,a,{set(c){e(this.canvas,{type:Ae["2D"],property:a,args:[c],setter:!0})}});i.push(o)}return()=>{i.forEach(a=>a())}}function Vi(e){return e==="experimental-webgl"?"webgl":e}function wr(e,t,r,n){const i=[];try{const s=ke(e.HTMLCanvasElement.prototype,"getContext",function(a){return function(l,...o){if(!ce(this,t,r,!0)){const c=Vi(l);if("__context"in this||(this.__context=c),n&&["webgl","webgl2"].includes(c))if(o[0]&&typeof o[0]=="object"){const u=o[0];u.preserveDrawingBuffer||(u.preserveDrawingBuffer=!0)}else o.splice(0,1,{preserveDrawingBuffer:!0})}return a.apply(this,[l,...o])}});i.push(s)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{i.forEach(s=>s())}}function Er(e,t,r,n,i,s,a){const l=[],o=Object.getOwnPropertyNames(e);for(const c of o)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(c))try{if(typeof e[c]!="function")continue;const u=ke(e,c,function(d){return function(...f){const h=d.apply(this,f);if(ln(h,a,this),"tagName"in this.canvas&&!ce(this.canvas,n,i,!0)){const p=cn([...f],a,this),m={type:t,property:c,args:p};r(this.canvas,m)}return h}});l.push(u)}catch{const d=it(e,c,{set(f){r(this.canvas,{type:t,property:c,args:[f],setter:!0})}});l.push(d)}return l}function Pi(e,t,r,n,i){const s=[];return s.push(...Er(t.WebGLRenderingContext.prototype,Ae.WebGL,e,r,n,i,t)),typeof t.WebGL2RenderingContext<"u"&&s.push(...Er(t.WebGL2RenderingContext.prototype,Ae.WebGL2,e,r,n,i,t)),()=>{s.forEach(a=>a())}}function Gi(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),i=0,s=r.length;i<s;++i)n[i]=r.charCodeAt(i);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}function Zi(e,t,r){var n=t===void 0?null:t,i=r===void 0?!1:r,s=Gi(e,i),a=s.indexOf(`
`,10)+1,l=s.substring(a)+(n?"//# sourceMappingURL="+n:""),o=new Blob([l],{type:"application/javascript"});return URL.createObjectURL(o)}function Hi(e,t,r){var n;return function(s){return n=n||Zi(e,t,r),new Worker(n,s)}}var Yi=Hi("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=",null,!1);class zi{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(o,c)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(o)||this.pendingCanvasMutations.set(o,[]),this.pendingCanvasMutations.get(o).push(c)};const{sampling:r="all",win:n,blockClass:i,blockSelector:s,recordCanvas:a,dataURLOptions:l}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,a&&r==="all"&&this.initCanvasMutationObserver(n,i,s),a&&typeof r=="number"&&this.initCanvasFPSObserver(r,n,i,s,{dataURLOptions:l})}initCanvasFPSObserver(t,r,n,i,s){const a=wr(r,n,i,!0),l=new Map,o=new Yi;o.onmessage=p=>{const{id:m}=p.data;if(l.set(m,!1),!("base64"in p.data))return;const{base64:I,type:y,width:v,height:g}=p.data;this.mutationCb({id:m,type:Ae["2D"],commands:[{property:"clearRect",args:[0,0,v,g]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:I}],type:y}]},0,0]}]})};const c=1e3/t;let u=0,d;const f=()=>{const p=[];return r.document.querySelectorAll("canvas").forEach(m=>{ce(m,n,i,!0)||p.push(m)}),p},h=p=>{if(u&&p-u<c){d=requestAnimationFrame(h);return}u=p,f().forEach(m=>be(this,void 0,void 0,function*(){var I;const y=this.mirror.getId(m);if(l.get(y))return;if(l.set(y,!0),["webgl","webgl2"].includes(m.__context)){const g=m.getContext(m.__context);((I=g==null?void 0:g.getContextAttributes())===null||I===void 0?void 0:I.preserveDrawingBuffer)===!1&&g.clear(g.COLOR_BUFFER_BIT)}const v=yield createImageBitmap(m);o.postMessage({id:y,bitmap:v,width:m.width,height:m.height,dataURLOptions:s.dataURLOptions},[v])})),d=requestAnimationFrame(h)};d=requestAnimationFrame(h),this.resetObservers=()=>{a(),cancelAnimationFrame(d)}}initCanvasMutationObserver(t,r,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const i=wr(t,r,n,!1),s=Ui(this.processMutation.bind(this),t,r,n),a=Pi(this.processMutation.bind(this),t,r,n,this.mirror);this.resetObservers=()=>{i(),s(),a()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=r=>{this.rafStamps.latestId=r,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,r)=>{const n=this.mirror.getId(r);this.flushPendingCanvasMutationFor(r,n)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,r){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(t);if(!n||r===-1)return;const i=n.map(a=>Fi(a,["type"])),{type:s}=n[0];this.mutationCb({id:r,type:s,commands:i}),this.pendingCanvasMutations.delete(t)}}class Ki{constructor(t){this.trackedLinkElements=new WeakSet,this.styleMirror=new ir,this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,r){"_cssText"in r.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:r.id,attributes:r.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,r){if(t.length===0)return;const n={id:r,styleIds:[]},i=[];for(const s of t){let a;if(this.styleMirror.has(s))a=this.styleMirror.getId(s);else{a=this.styleMirror.add(s);const l=Array.from(s.rules||CSSRule);i.push({styleId:a,rules:l.map((o,c)=>({rule:Hr(o),index:c}))})}n.styleIds.push(a)}i.length>0&&(n.styles=i),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class ji{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(t,r){const n=this.nodeMap.get(t);return n&&Array.from(n).some(i=>i!==r)}add(t,r){this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(r))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}function re(e){return Object.assign(Object.assign({},e),{timestamp:tt()})}let te,ht,Tt,It=!1;const ve=Yr();function Ye(e={}){const{emit:t,checkoutEveryNms:r,checkoutEveryNth:n,blockClass:i="rr-block",blockSelector:s=null,ignoreClass:a="rr-ignore",ignoreSelector:l=null,maskTextClass:o="rr-mask",maskTextSelector:c=null,inlineStylesheet:u=!0,maskAllInputs:d,maskInputOptions:f,slimDOMOptions:h,maskInputFn:p,maskTextFn:m,hooks:I,packFn:y,sampling:v={},dataURLOptions:g={},mousemoveWait:b,recordCanvas:N=!1,recordCrossOriginIframes:T=!1,recordAfter:k=e.recordAfter==="DOMContentLoaded"?e.recordAfter:"load",userTriggeredOnInput:A=!1,collectFonts:K=!1,inlineImages:_=!1,plugins:j,keepIframeSrcFn:U=()=>!1,ignoreCSSAttributes:G=new Set([]),errorHandler:z}=e;Ci(z);const L=T?window.parent===window:!0;let F=!1;if(!L)try{window.parent.document&&(F=!1)}catch{F=!0}if(L&&!t)throw new Error("emit function is required");b!==void 0&&v.mousemove===void 0&&(v.mousemove=b),ve.reset();const D=d===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:f!==void 0?f:{password:!0},Z=h===!0||h==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:h==="all",headMetaDescKeywords:h==="all"}:h||{};er();let S,C=0;const E=O=>{for(const ie of j||[])ie.eventProcessor&&(O=ie.eventProcessor(O));return y&&!F&&(O=y(O)),O};te=(O,ie)=>{var V;if(!((V=De[0])===null||V===void 0)&&V.isFrozen()&&O.type!==R.FullSnapshot&&!(O.type===R.IncrementalSnapshot&&O.data.source===w.Mutation)&&De.forEach(ne=>ne.unfreeze()),L)t==null||t(E(O),ie);else if(F){const ne={type:"rrweb",event:E(O),origin:window.location.origin,isCheckout:ie};window.parent.postMessage(ne,"*")}if(O.type===R.FullSnapshot)S=O,C=0;else if(O.type===R.IncrementalSnapshot){if(O.data.source===w.Mutation&&O.data.isAttachIframe)return;C++;const ne=n&&C>=n,me=r&&O.timestamp-S.timestamp>r;(ne||me)&&ht(!0)}};const M=O=>{te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.Mutation},O)}))},H=O=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.Scroll},O)})),J=O=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.CanvasMutation},O)})),ee=O=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.AdoptedStyleSheet},O)})),oe=new Ki({mutationCb:M,adoptedStyleSheetCb:ee}),ae=new xi({mirror:ve,mutationCb:M,stylesheetManager:oe,recordCrossOriginIframes:T,wrappedEmit:te});for(const O of j||[])O.getMirror&&O.getMirror({nodeMirror:ve,crossOriginIframeMirror:ae.crossOriginIframeMirror,crossOriginIframeStyleMirror:ae.crossOriginIframeStyleMirror});const de=new ji;Tt=new zi({recordCanvas:N,mutationCb:J,win:window,blockClass:i,blockSelector:s,mirror:ve,sampling:v.canvas,dataURLOptions:g});const fe=new Li({mutationCb:M,scrollCb:H,bypassOptions:{blockClass:i,blockSelector:s,maskTextClass:o,maskTextSelector:c,inlineStylesheet:u,maskInputOptions:D,dataURLOptions:g,maskTextFn:m,maskInputFn:p,recordCanvas:N,inlineImages:_,sampling:v,slimDOMOptions:Z,iframeManager:ae,stylesheetManager:oe,canvasManager:Tt,keepIframeSrcFn:U,processedNodeManager:de},mirror:ve});ht=(O=!1)=>{te(re({type:R.Meta,data:{href:window.location.href,width:qt(),height:Qt()}}),O),oe.reset(),fe.init(),De.forEach(V=>V.lock());const ie=li(document,{mirror:ve,blockClass:i,blockSelector:s,maskTextClass:o,maskTextSelector:c,inlineStylesheet:u,maskAllInputs:D,maskTextFn:m,slimDOM:Z,dataURLOptions:g,recordCanvas:N,inlineImages:_,onSerialize:V=>{Ze(V,ve)&&ae.addIframe(V),rr(V,ve)&&oe.trackLinkElement(V),Ee(V)&&fe.addShadowRoot(V.shadowRoot,document)},onIframeLoad:(V,ne)=>{ae.attachIframe(V,ne),fe.observeAttachShadow(V)},onStylesheetLoad:(V,ne)=>{oe.attachLinkElement(V,ne)},keepIframeSrcFn:U});if(!ie)return console.warn("Failed to snapshot the document");te(re({type:R.FullSnapshot,data:{node:ie,initialOffset:Jt(window)}}),O),De.forEach(V=>V.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&oe.adoptStyleSheets(document.adoptedStyleSheets,ve.getId(document))};try{const O=[],ie=ne=>{var me;return W(Oi)({mutationCb:M,mousemoveCb:(q,Et)=>te(re({type:R.IncrementalSnapshot,data:{source:Et,positions:q}})),mouseInteractionCb:q=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.MouseInteraction},q)})),scrollCb:H,viewportResizeCb:q=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.ViewportResize},q)})),inputCb:q=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.Input},q)})),mediaInteractionCb:q=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.MediaInteraction},q)})),styleSheetRuleCb:q=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.StyleSheetRule},q)})),styleDeclarationCb:q=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.StyleDeclaration},q)})),canvasMutationCb:J,fontCb:q=>te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.Font},q)})),selectionCb:q=>{te(re({type:R.IncrementalSnapshot,data:Object.assign({source:w.Selection},q)}))},blockClass:i,ignoreClass:a,ignoreSelector:l,maskTextClass:o,maskTextSelector:c,maskInputOptions:D,inlineStylesheet:u,sampling:v,recordCanvas:N,inlineImages:_,userTriggeredOnInput:A,collectFonts:K,doc:ne,maskInputFn:p,maskTextFn:m,keepIframeSrcFn:U,blockSelector:s,slimDOMOptions:Z,dataURLOptions:g,mirror:ve,iframeManager:ae,stylesheetManager:oe,shadowDomManager:fe,processedNodeManager:de,canvasManager:Tt,ignoreCSSAttributes:G,plugins:((me=j==null?void 0:j.filter(q=>q.observer))===null||me===void 0?void 0:me.map(q=>({observer:q.observer,options:q.options,callback:Et=>te(re({type:R.Plugin,data:{plugin:q.name,payload:Et}}))})))||[]},I)};ae.addLoadListener(ne=>{try{O.push(ie(ne.contentDocument))}catch(me){console.warn(me)}});const V=()=>{ht(),O.push(ie(document)),It=!0};return document.readyState==="interactive"||document.readyState==="complete"?V():(O.push(le("DOMContentLoaded",()=>{te(re({type:R.DomContentLoaded,data:{}})),k==="DOMContentLoaded"&&V()})),O.push(le("load",()=>{te(re({type:R.Load,data:{}})),k==="load"&&V()},window))),()=>{O.forEach(ne=>ne()),de.destroy(),It=!1,Ii()}}catch(O){console.warn(O)}}Ye.addCustomEvent=(e,t)=>{if(!It)throw new Error("please add custom event after start recording");te(re({type:R.Custom,data:{tag:e,payload:t}}))};Ye.freezePage=()=>{De.forEach(e=>e.freeze())};Ye.takeFullSnapshot=e=>{if(!It)throw new Error("please take full snapshot after start recording");ht(e)};Ye.mirror=ve;var B;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(B||(B={}));var Xi=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var r;if(!t)return-1;var n=(r=this.getMeta(t))===null||r===void 0?void 0:r.id;return n??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var r=this,n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(function(i){return r.removeNodeFromMap(i)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,r){var n=r.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,r)},e.prototype.replace=function(t,r){var n=this.getNode(t);if(n){var i=this.nodeMetaMap.get(n);i&&this.nodeMetaMap.set(r,i)}this.idNodeMap.set(t,r)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Ji(){return new Xi}function Qi(e){const t={},r=/;(?![^(]*\))/g,n=/:(.+)/,i=/\/\*.*?\*\//g;return e.replace(i,"").split(r).forEach(function(s){if(s){const a=s.split(n);a.length>1&&(t[Wt(a[0].trim())]=a[1].trim())}}),t}function Tr(e){const t=[];for(const r in e){const n=e[r];if(typeof n!="string")continue;const i=ts(r);t.push(`${i}: ${n};`)}return t.join(" ")}const qi=/-([a-z])/g,$i=/^--[a-zA-Z0-9-]+$/,Wt=e=>$i.test(e)?e:e.replace(qi,(t,r)=>r?r.toUpperCase():""),es=/\B([A-Z])/g,ts=e=>e.replace(es,"-$1").toLowerCase();class pe{constructor(...t){this.parentElement=null,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.ELEMENT_NODE=$.ELEMENT_NODE,this.TEXT_NODE=$.TEXT_NODE}get childNodes(){const t=[];let r=this.firstChild;for(;r;)t.push(r),r=r.nextSibling;return t}contains(t){if(t instanceof pe){if(t.ownerDocument!==this.ownerDocument)return!1;if(t===this)return!0}else return!1;for(;t.parentNode;){if(t.parentNode===this)return!0;t=t.parentNode}return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,r){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function rs(e){return class dn extends e{constructor(...r){super(r),this.nodeType=$.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=B.Document,this.textContent=null,this.ownerDocument=this}get documentElement(){return this.childNodes.find(r=>r.RRNodeType===B.Element&&r.tagName==="HTML")||null}get body(){var r;return((r=this.documentElement)===null||r===void 0?void 0:r.childNodes.find(n=>n.RRNodeType===B.Element&&n.tagName==="BODY"))||null}get head(){var r;return((r=this.documentElement)===null||r===void 0?void 0:r.childNodes.find(n=>n.RRNodeType===B.Element&&n.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(r){const n=r.RRNodeType;if((n===B.Element||n===B.DocumentType)&&this.childNodes.some(s=>s.RRNodeType===n))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${n===B.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const i=ar(this,r);return i.parentElement=null,i}insertBefore(r,n){const i=r.RRNodeType;if((i===B.Element||i===B.DocumentType)&&this.childNodes.some(a=>a.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${i===B.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const s=vn(this,r,n);return s.parentElement=null,s}removeChild(r){return yn(this,r)}open(){this.firstChild=null,this.lastChild=null}close(){}write(r){let n;if(r==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?n="-//W3C//DTD XHTML 1.0 Transitional//EN":r==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(n="-//W3C//DTD HTML 4.0 Transitional//EN"),n){const i=this.createDocumentType("html",n,"");this.open(),this.appendChild(i)}}createDocument(r,n,i){return new dn}createDocumentType(r,n,i){const s=new(fn(pe))(r,n,i);return s.ownerDocument=this,s}createElement(r){const n=new(hn(pe))(r);return n.ownerDocument=this,n}createElementNS(r,n){return this.createElement(n)}createTextNode(r){const n=new(pn(pe))(r);return n.ownerDocument=this,n}createComment(r){const n=new(mn(pe))(r);return n.ownerDocument=this,n}createCDATASection(r){const n=new(gn(pe))(r);return n.ownerDocument=this,n}toString(){return"RRDocument"}}}function fn(e){return class extends e{constructor(r,n,i){super(),this.nodeType=$.DOCUMENT_TYPE_NODE,this.RRNodeType=B.DocumentType,this.name=r,this.publicId=n,this.systemId=i,this.nodeName=r,this.textContent=null}toString(){return"RRDocumentType"}}}function hn(e){return class extends e{constructor(r){super(),this.nodeType=$.ELEMENT_NODE,this.RRNodeType=B.Element,this.attributes={},this.shadowRoot=null,this.tagName=r.toUpperCase(),this.nodeName=r.toUpperCase()}get textContent(){let r="";return this.childNodes.forEach(n=>r+=n.textContent),r}set textContent(r){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(r))}get classList(){return new is(this.attributes.class,r=>{this.attributes.class=r})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const r=this.attributes.style?Qi(this.attributes.style):{},n=/\B([A-Z])/g;return r.setProperty=(i,s,a)=>{if(n.test(i))return;const l=Wt(i);s?r[l]=s:delete r[l],a==="important"&&(r[l]+=" !important"),this.attributes.style=Tr(r)},r.removeProperty=i=>{if(n.test(i))return"";const s=Wt(i),a=r[s]||"";return delete r[s],this.attributes.style=Tr(r),a},r}getAttribute(r){return this.attributes[r]||null}setAttribute(r,n){this.attributes[r]=n}setAttributeNS(r,n,i){this.setAttribute(n,i)}removeAttribute(r){delete this.attributes[r]}appendChild(r){return ar(this,r)}insertBefore(r,n){return vn(this,r,n)}removeChild(r){return yn(this,r)}attachShadow(r){const n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(r){return!0}toString(){let r="";for(const n in this.attributes)r+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${r}`}}}function ns(e){return class extends e{attachShadow(r){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function pn(e){return class extends e{constructor(r){super(),this.nodeType=$.TEXT_NODE,this.nodeName="#text",this.RRNodeType=B.Text,this.data=r}get textContent(){return this.data}set textContent(r){this.data=r}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function mn(e){return class extends e{constructor(r){super(),this.nodeType=$.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=B.Comment,this.data=r}get textContent(){return this.data}set textContent(r){this.data=r}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function gn(e){return class extends e{constructor(r){super(),this.nodeName="#cdata-section",this.nodeType=$.CDATA_SECTION_NODE,this.RRNodeType=B.CDATA,this.data=r}get textContent(){return this.data}set textContent(r){this.data=r}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class is{constructor(t,r){if(this.classes=[],this.add=(...n)=>{for(const i of n){const s=String(i);this.classes.indexOf(s)>=0||this.classes.push(s)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...n)=>{this.classes=this.classes.filter(i=>n.indexOf(i)===-1),this.onChange&&this.onChange(this.classes.join(" "))},t){const n=t.trim().split(/\s+/);this.classes.push(...n)}this.onChange=r}}function ar(e,t){return t.parentNode&&t.parentNode.removeChild(t),e.lastChild?(e.lastChild.nextSibling=t,t.previousSibling=e.lastChild):(e.firstChild=t,t.previousSibling=null),e.lastChild=t,t.nextSibling=null,t.parentNode=e,t.parentElement=e,t.ownerDocument=e.ownerDocument,t}function vn(e,t,r){if(!r)return ar(e,t);if(r.parentNode!==e)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return t===r||(t.parentNode&&t.parentNode.removeChild(t),t.previousSibling=r.previousSibling,r.previousSibling=t,t.nextSibling=r,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,t.parentElement=e,t.parentNode=e,t.ownerDocument=e.ownerDocument),t}function yn(e,t){if(t.parentNode!==e)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return t.previousSibling?t.previousSibling.nextSibling=t.nextSibling:e.firstChild=t.nextSibling,t.nextSibling?t.nextSibling.previousSibling=t.previousSibling:e.lastChild=t.previousSibling,t.previousSibling=null,t.nextSibling=null,t.parentElement=null,t.parentNode=null,t}var $;(function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})($||($={}));const Ut={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},ss={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};let he=null;function St(e,t,r,n=t.mirror||t.ownerDocument.mirror){e=os(e,t,r,n),Cn(e,t,r,n),as(e,t,r,n)}function os(e,t,r,n){var i;if(r.afterAppend&&!he&&(he=new WeakSet,setTimeout(()=>{he=null},0)),!lr(e,t)){const s=bt(t,r.mirror,n);(i=e.parentNode)===null||i===void 0||i.replaceChild(s,e),e=s}switch(t.RRNodeType){case B.Document:{if(!_e(e,t,r.mirror,n)){const s=n.getMeta(t);s&&(r.mirror.removeNodeFromMap(e),e.close(),e.open(),r.mirror.add(e,s),he==null||he.add(e))}break}case B.Element:{const s=e,a=t;switch(a.tagName){case"IFRAME":{const l=e.contentDocument;if(!l)break;St(l,t.contentDocument,r,n);break}}a.shadowRoot&&(s.shadowRoot||s.attachShadow({mode:"open"}),Cn(s.shadowRoot,a.shadowRoot,r,n));break}}return e}function as(e,t,r,n){var i;switch(t.RRNodeType){case B.Document:{const s=t.scrollData;s&&r.applyScroll(s,!0);break}case B.Element:{const s=e,a=t;switch(ls(s,a,n),a.scrollData&&r.applyScroll(a.scrollData,!0),a.inputData&&r.applyInput(a.inputData),a.tagName){case"AUDIO":case"VIDEO":{const l=e,o=a;o.paused!==void 0&&(o.paused?l.pause():l.play()),o.muted!==void 0&&(l.muted=o.muted),o.volume!==void 0&&(l.volume=o.volume),o.currentTime!==void 0&&(l.currentTime=o.currentTime),o.playbackRate!==void 0&&(l.playbackRate=o.playbackRate);break}case"CANVAS":{const l=t;if(l.rr_dataURL!==null){const o=document.createElement("img");o.onload=()=>{const c=s.getContext("2d");c&&c.drawImage(o,0,0,o.width,o.height)},o.src=l.rr_dataURL}l.canvasMutations.forEach(o=>r.applyCanvas(o.event,o.mutation,e));break}case"STYLE":{const l=s.sheet;l&&t.rules.forEach(o=>r.applyStyleSheetMutation(o,l));break}}break}case B.Text:case B.Comment:case B.CDATA:{e.textContent!==t.data&&(e.textContent=t.data);break}}he!=null&&he.has(e)&&(he.delete(e),(i=r.afterAppend)===null||i===void 0||i.call(r,e,r.mirror.getId(e)))}function ls(e,t,r){const n=e.attributes,i=t.attributes;for(const s in i){const a=i[s],l=r.getMeta(t);if(l!=null&&l.isSVG&&Ut[s])e.setAttributeNS(Ut[s],s,a);else if(t.tagName==="CANVAS"&&s==="rr_dataURL"){const o=document.createElement("img");o.src=a,o.onload=()=>{const c=e.getContext("2d");c&&c.drawImage(o,0,0,o.width,o.height)}}else{if(t.tagName==="IFRAME"&&s==="srcdoc")continue;e.setAttribute(s,a)}}for(const{name:s}of Array.from(n))s in i||e.removeAttribute(s);t.scrollLeft&&(e.scrollLeft=t.scrollLeft),t.scrollTop&&(e.scrollTop=t.scrollTop)}function Cn(e,t,r,n){const i=Array.from(e.childNodes),s=t.childNodes;if(i.length===0&&s.length===0)return;let a=0,l=i.length-1,o=0,c=s.length-1,u=i[a],d=i[l],f=s[o],h=s[c],p,m;for(;a<=l&&o<=c;)if(u===void 0)u=i[++a];else if(d===void 0)d=i[--l];else if(_e(u,f,r.mirror,n))u=i[++a],f=s[++o];else if(_e(d,h,r.mirror,n))d=i[--l],h=s[--c];else if(_e(u,h,r.mirror,n)){try{e.insertBefore(u,d.nextSibling)}catch(v){console.warn(v)}u=i[++a],h=s[--c]}else if(_e(d,f,r.mirror,n)){try{e.insertBefore(d,u)}catch(v){console.warn(v)}d=i[--l],f=s[++o]}else{if(!p){p={};for(let g=a;g<=l;g++){const b=i[g];b&&r.mirror.hasNode(b)&&(p[r.mirror.getId(b)]=g)}}m=p[n.getId(f)];const v=i[m];if(m!==void 0&&v&&_e(v,f,r.mirror,n)){try{e.insertBefore(v,u)}catch(g){console.warn(g)}i[m]=void 0}else{const g=bt(f,r.mirror,n);e.nodeName==="#document"&&u&&(g.nodeType===g.DOCUMENT_TYPE_NODE&&u.nodeType===u.DOCUMENT_TYPE_NODE||g.nodeType===g.ELEMENT_NODE&&u.nodeType===u.ELEMENT_NODE)&&(e.removeChild(u),r.mirror.removeNodeFromMap(u),u=i[++a]);try{e.insertBefore(g,u||null)}catch(b){console.warn(b)}}f=s[++o]}if(a>l){const v=s[c+1];let g=null;for(v&&(g=r.mirror.getNode(n.getId(v)));o<=c;++o){const b=bt(s[o],r.mirror,n);try{e.insertBefore(b,g)}catch(N){console.warn(N)}}}else if(o>c)for(;a<=l;a++){const v=i[a];if(!(!v||v.parentNode!==e))try{e.removeChild(v),r.mirror.removeNodeFromMap(v)}catch(g){console.warn(g)}}let I=e.firstChild,y=t.firstChild;for(;I!==null&&y!==null;)St(I,y,r,n),I=I.nextSibling,y=y.nextSibling}function bt(e,t,r){const n=r.getId(e),i=r.getMeta(e);let s=null;if(n>-1&&(s=t.getNode(n)),s!==null&&lr(s,e))return s;switch(e.RRNodeType){case B.Document:s=new Document;break;case B.DocumentType:s=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case B.Element:{let a=e.tagName.toLowerCase();a=ss[a]||a,i&&"isSVG"in i&&(i!=null&&i.isSVG)?s=document.createElementNS(Ut.svg,a):s=document.createElement(e.tagName);break}case B.Text:s=document.createTextNode(e.data);break;case B.Comment:s=document.createComment(e.data);break;case B.CDATA:s=document.createCDATASection(e.data);break}i&&t.add(s,Object.assign({},i));try{he==null||he.add(s)}catch{}return s}function lr(e,t){return e.nodeType!==t.nodeType?!1:e.nodeType!==e.ELEMENT_NODE||e.tagName.toUpperCase()===t.tagName}function _e(e,t,r,n){const i=r.getId(e),s=n.getId(t);return i===-1||i!==s?!1:lr(e,t)}class ze extends rs(pe){get unserializedId(){return this._unserializedId--}constructor(t){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=Cs(),this.scrollData=null,t&&(this.mirror=t)}createDocument(t,r,n){return new ze}createDocumentType(t,r,n){const i=new cs(t,r,n);return i.ownerDocument=this,i}createElement(t){const r=t.toUpperCase();let n;switch(r){case"AUDIO":case"VIDEO":n=new us(r);break;case"IFRAME":n=new hs(r,this.mirror);break;case"CANVAS":n=new ds(r);break;case"STYLE":n=new fs(r);break;default:n=new ot(r);break}return n.ownerDocument=this,n}createComment(t){const r=new ms(t);return r.ownerDocument=this,r}createCDATASection(t){const r=new gs(t);return r.ownerDocument=this,r}createTextNode(t){const r=new ps(t);return r.ownerDocument=this,r}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const cs=fn(pe);class ot extends hn(pe){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class us extends ns(ot){}class ds extends ot{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class fs extends ot{constructor(){super(...arguments),this.rules=[]}}class hs extends ot{constructor(t,r){super(t),this.contentDocument=new ze,this.contentDocument.mirror=r}}const ps=pn(pe),ms=mn(pe),gs=gn(pe);function vs(e){return e instanceof HTMLFormElement?"FORM":e.tagName.toUpperCase()}function In(e,t,r,n){let i;switch(e.nodeType){case $.DOCUMENT_NODE:n&&n.nodeName==="IFRAME"?i=n.contentDocument:(i=t,i.compatMode=e.compatMode);break;case $.DOCUMENT_TYPE_NODE:{const a=e;i=t.createDocumentType(a.name,a.publicId,a.systemId);break}case $.ELEMENT_NODE:{const a=e,l=vs(a);i=t.createElement(l);const o=i;for(const{name:c,value:u}of Array.from(a.attributes))o.attributes[c]=u;a.scrollLeft&&(o.scrollLeft=a.scrollLeft),a.scrollTop&&(o.scrollTop=a.scrollTop);break}case $.TEXT_NODE:i=t.createTextNode(e.textContent||"");break;case $.CDATA_SECTION_NODE:i=t.createCDATASection(e.data);break;case $.COMMENT_NODE:i=t.createComment(e.textContent||"");break;case $.DOCUMENT_FRAGMENT_NODE:i=n.attachShadow({mode:"open"});break;default:return null}let s=r.getMeta(e);return t instanceof ze&&(s||(s=Sn(i,t.unserializedId),r.add(e,s)),t.mirror.add(i,Object.assign({},s))),i}function ys(e,t=Ji(),r=new ze){function n(i,s){const a=In(i,r,t,s);if(a!==null)if((s==null?void 0:s.nodeName)!=="IFRAME"&&i.nodeType!==$.DOCUMENT_FRAGMENT_NODE&&(s==null||s.appendChild(a),a.parentNode=s,a.parentElement=s),i.nodeName==="IFRAME"){const l=i.contentDocument;l&&n(l,a)}else(i.nodeType===$.DOCUMENT_NODE||i.nodeType===$.ELEMENT_NODE||i.nodeType===$.DOCUMENT_FRAGMENT_NODE)&&(i.nodeType===$.ELEMENT_NODE&&i.shadowRoot&&n(i.shadowRoot,a),i.childNodes.forEach(l=>n(l,a)))}return n(e,null),r}function Cs(){return new Is}class Is{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var r;if(!t)return-1;const n=(r=this.getMeta(t))===null||r===void 0?void 0:r.id;return n??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(n=>this.removeNodeFromMap(n))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,r){const n=r.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,r)}replace(t,r){const n=this.getNode(t);if(n){const i=this.nodeMetaMap.get(n);i&&this.nodeMetaMap.set(r,i)}this.idNodeMap.set(t,r)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Sn(e,t){switch(e.RRNodeType){case B.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case B.DocumentType:{const r=e;return{id:t,type:e.RRNodeType,name:r.name,publicId:r.publicId,systemId:r.systemId}}case B.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case B.Text:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case B.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case B.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}const{addCustomEvent:fo}=Ye,{freezePage:ho}=Ye;var se=Uint8Array,ue=Uint16Array,rt=Uint32Array,Nt=new se([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),wt=new se([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Vt=new se([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bn=function(e,t){for(var r=new ue(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new rt(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},An=bn(Nt,2),Nn=An[0],Pt=An[1];Nn[28]=258,Pt[258]=28;var wn=bn(wt,0),Ss=wn[0],Mr=wn[1],Gt=new ue(32768);for(var Q=0;Q<32768;++Q){var Ne=(Q&43690)>>>1|(Q&21845)<<1;Ne=(Ne&52428)>>>2|(Ne&13107)<<2,Ne=(Ne&61680)>>>4|(Ne&3855)<<4,Gt[Q]=((Ne&65280)>>>8|(Ne&255)<<8)>>>1}var ye=function(e,t,r){for(var n=e.length,i=0,s=new ue(t);i<n;++i)++s[e[i]-1];var a=new ue(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;var l;if(r){l=new ue(1<<t);var o=15-t;for(i=0;i<n;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],d=a[e[i]-1]++<<u,f=d|(1<<u)-1;d<=f;++d)l[Gt[d]>>>o]=c}else for(l=new ue(n),i=0;i<n;++i)l[i]=Gt[a[e[i]-1]++]>>>15-e[i];return l},Re=new se(288);for(var Q=0;Q<144;++Q)Re[Q]=8;for(var Q=144;Q<256;++Q)Re[Q]=9;for(var Q=256;Q<280;++Q)Re[Q]=7;for(var Q=280;Q<288;++Q)Re[Q]=8;var nt=new se(32);for(var Q=0;Q<32;++Q)nt[Q]=5;var bs=ye(Re,9,0),As=ye(Re,9,1),Ns=ye(nt,5,0),ws=ye(nt,5,1),Mt=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},ge=function(e,t,r){var n=t/8>>0;return(e[n]|e[n+1]<<8)>>>(t&7)&r},Rt=function(e,t){var r=t/8>>0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>>(t&7)},cr=function(e){return(e/8>>0)+(e&7&&1)},ur=function(e,t,r){(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length);var n=new(e instanceof ue?ue:e instanceof rt?rt:se)(r-t);return n.set(e.subarray(t,r)),n},Es=function(e,t,r){var n=e.length,i=!t||r,s=!r||r.i;r||(r={}),t||(t=new se(n*3));var a=function(oe){var ae=t.length;if(oe>ae){var de=new se(Math.max(ae*2,oe));de.set(t),t=de}},l=r.f||0,o=r.p||0,c=r.b||0,u=r.l,d=r.d,f=r.m,h=r.n,p=n*8;do{if(!u){r.f=l=ge(e,o,1);var m=ge(e,o+1,3);if(o+=3,m)if(m==1)u=As,d=ws,f=9,h=5;else if(m==2){var g=ge(e,o,31)+257,b=ge(e,o+10,15)+4,N=g+ge(e,o+5,31)+1;o+=14;for(var T=new se(N),k=new se(19),A=0;A<b;++A)k[Vt[A]]=ge(e,o+A*3,7);o+=b*3;var K=Mt(k),_=(1<<K)-1;if(!s&&o+N*(K+7)>p)break;for(var j=ye(k,K,1),A=0;A<N;){var U=j[ge(e,o,_)];o+=U&15;var I=U>>>4;if(I<16)T[A++]=I;else{var G=0,z=0;for(I==16?(z=3+ge(e,o,3),o+=2,G=T[A-1]):I==17?(z=3+ge(e,o,7),o+=3):I==18&&(z=11+ge(e,o,127),o+=7);z--;)T[A++]=G}}var L=T.subarray(0,g),F=T.subarray(g);f=Mt(L),h=Mt(F),u=ye(L,f,1),d=ye(F,h,1)}else throw"invalid block type";else{var I=cr(o)+4,y=e[I-4]|e[I-3]<<8,v=I+y;if(v>n){if(s)throw"unexpected EOF";break}i&&a(c+y),t.set(e.subarray(I,v),c),r.b=c+=y,r.p=o=v*8;continue}if(o>p)throw"unexpected EOF"}i&&a(c+131072);for(var D=(1<<f)-1,Z=(1<<h)-1,S=f+h+18;s||o+S<p;){var G=u[Rt(e,o)&D],C=G>>>4;if(o+=G&15,o>p)throw"unexpected EOF";if(!G)throw"invalid length/literal";if(C<256)t[c++]=C;else if(C==256){u=null;break}else{var E=C-254;if(C>264){var A=C-257,M=Nt[A];E=ge(e,o,(1<<M)-1)+Nn[A],o+=M}var H=d[Rt(e,o)&Z],J=H>>>4;if(!H)throw"invalid distance";o+=H&15;var F=Ss[J];if(J>3){var M=wt[J];F+=Rt(e,o)&(1<<M)-1,o+=M}if(o>p)throw"unexpected EOF";i&&a(c+131072);for(var ee=c+E;c<ee;c+=4)t[c]=t[c-F],t[c+1]=t[c+1-F],t[c+2]=t[c+2-F],t[c+3]=t[c+3-F];c=ee}}r.l=u,r.p=o,r.b=c,u&&(l=1,r.m=f,r.d=d,r.n=h)}while(!l);return c==t.length?t:ur(t,0,c)},Ie=function(e,t,r){r<<=t&7;var n=t/8>>0;e[n]|=r,e[n+1]|=r>>>8},Ke=function(e,t,r){r<<=t&7;var n=t/8>>0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},Dt=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return[new se(0),0];if(i==1){var a=new se(r[0].s+1);return a[r[0].s]=1,[a,1]}r.sort(function(N,T){return N.f-T.f}),r.push({s:-1,f:25001});var l=r[0],o=r[1],c=0,u=1,d=2;for(r[0]={s:-1,f:l.f+o.f,l,r:o};u!=i-1;)l=r[r[c].f<r[d].f?c++:d++],o=r[c!=u&&r[c].f<r[d].f?c++:d++],r[u++]={s:-1,f:l.f+o.f,l,r:o};for(var f=s[0].s,n=1;n<i;++n)s[n].s>f&&(f=s[n].s);var h=new ue(f+1),p=Zt(r[u-1],h,0);if(p>t){var n=0,m=0,I=p-t,y=1<<I;for(s.sort(function(T,k){return h[k.s]-h[T.s]||T.f-k.f});n<i;++n){var v=s[n].s;if(h[v]>t)m+=y-(1<<p-h[v]),h[v]=t;else break}for(m>>>=I;m>0;){var g=s[n].s;h[g]<t?m-=1<<t-h[g]++-1:++n}for(;n>=0&&m;--n){var b=s[n].s;h[b]==t&&(--h[b],++m)}p=t}return[new se(h),p]},Zt=function(e,t,r){return e.s==-1?Math.max(Zt(e.l,t,r+1),Zt(e.r,t,r+1)):t[e.s]=r},Rr=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ue(++t),n=0,i=e[0],s=1,a=function(o){r[n++]=o},l=1;l<=t;++l)if(e[l]==i&&l!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=e[l]}return[r.subarray(0,n),t]},je=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},pt=function(e,t,r){var n=r.length,i=cr(t+2);e[i]=n&255,e[i+1]=n>>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},Dr=function(e,t,r,n,i,s,a,l,o,c,u){Ie(t,u++,r),++i[256];for(var d=Dt(i,15),f=d[0],h=d[1],p=Dt(s,15),m=p[0],I=p[1],y=Rr(f),v=y[0],g=y[1],b=Rr(m),N=b[0],T=b[1],k=new ue(19),A=0;A<v.length;++A)k[v[A]&31]++;for(var A=0;A<N.length;++A)k[N[A]&31]++;for(var K=Dt(k,7),_=K[0],j=K[1],U=19;U>4&&!_[Vt[U-1]];--U);var G=c+5<<3,z=je(i,Re)+je(s,nt)+a,L=je(i,f)+je(s,m)+a+14+3*U+je(k,_)+(2*k[16]+3*k[17]+7*k[18]);if(G<=z&&G<=L)return pt(t,u,e.subarray(o,o+c));var F,D,Z,S;if(Ie(t,u,1+(L<z)),u+=2,L<z){F=ye(f,h,0),D=f,Z=ye(m,I,0),S=m;var C=ye(_,j,0);Ie(t,u,g-257),Ie(t,u+5,T-1),Ie(t,u+10,U-4),u+=14;for(var A=0;A<U;++A)Ie(t,u+3*A,_[Vt[A]]);u+=3*U;for(var E=[v,N],M=0;M<2;++M)for(var H=E[M],A=0;A<H.length;++A){var J=H[A]&31;Ie(t,u,C[J]),u+=_[J],J>15&&(Ie(t,u,H[A]>>>5&127),u+=H[A]>>>12)}}else F=bs,D=Re,Z=Ns,S=nt;for(var A=0;A<l;++A)if(n[A]>255){var J=n[A]>>>18&31;Ke(t,u,F[J+257]),u+=D[J+257],J>7&&(Ie(t,u,n[A]>>>23&31),u+=Nt[J]);var ee=n[A]&31;Ke(t,u,Z[ee]),u+=S[ee],ee>3&&(Ke(t,u,n[A]>>>5&8191),u+=wt[ee])}else Ke(t,u,F[n[A]]),u+=D[n[A]];return Ke(t,u,F[256]),u+D[256]},Ts=new rt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ms=new se(0),Rs=function(e,t,r,n,i,s){var a=e.length,l=new se(n+a+5*(1+Math.floor(a/7e3))+i),o=l.subarray(n,l.length-i),c=0;if(!t||a<8)for(var u=0;u<=a;u+=65535){var d=u+65535;d<a?c=pt(o,c,e.subarray(u,d)):(o[u]=s,c=pt(o,c,e.subarray(u,a)))}else{for(var f=Ts[t-1],h=f>>>13,p=f&8191,m=(1<<r)-1,I=new ue(32768),y=new ue(m+1),v=Math.ceil(r/3),g=2*v,b=function(me){return(e[me]^e[me+1]<<v^e[me+2]<<g)&m},N=new rt(25e3),T=new ue(288),k=new ue(32),A=0,K=0,u=0,_=0,j=0,U=0;u<a;++u){var G=b(u),z=u&32767,L=y[G];if(I[z]=L,y[G]=z,j<=u){var F=a-u;if((A>7e3||_>24576)&&F>423){c=Dr(e,o,0,N,T,k,K,_,U,u-U,c),_=A=K=0,U=u;for(var D=0;D<286;++D)T[D]=0;for(var D=0;D<30;++D)k[D]=0}var Z=2,S=0,C=p,E=z-L&32767;if(F>2&&G==b(u-E))for(var M=Math.min(h,F)-1,H=Math.min(32767,u),J=Math.min(258,F);E<=H&&--C&&z!=L;){if(e[u+Z]==e[u+Z-E]){for(var ee=0;ee<J&&e[u+ee]==e[u+ee-E];++ee);if(ee>Z){if(Z=ee,S=E,ee>M)break;for(var oe=Math.min(E,ee-2),ae=0,D=0;D<oe;++D){var de=u-E+D+32768&32767,fe=I[de],O=de-fe+32768&32767;O>ae&&(ae=O,L=de)}}}z=L,L=I[z],E+=z-L+32768&32767}if(S){N[_++]=268435456|Pt[Z]<<18|Mr[S];var ie=Pt[Z]&31,V=Mr[S]&31;K+=Nt[ie]+wt[V],++T[257+ie],++k[V],j=u+Z,++A}else N[_++]=e[u],++T[e[u]]}}c=Dr(e,o,s,N,T,k,K,_,U,u-U,c),s||(c=pt(o,c,Ms))}return ur(l,0,n+cr(c)+i)},Ds=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length,a=0;a!=s;){for(var l=Math.min(a+5552,s);a<l;++a)n+=r[a],i+=n;n%=65521,i%=65521}e=n,t=i},d:function(){return(e>>>8<<16|(t&255)<<8|t>>>8)+((e&255)<<23)*2}}},ks=function(e,t,r,n,i){return Rs(e,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):12+t.mem,r,n,!i)},Os=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},xs=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;e[0]=120,e[1]=n<<6|(n?32-2*n:1)},Ls=function(e){if((e[0]&15)!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(e[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Fs(e,t){t===void 0&&(t={});var r=Ds();r.p(e);var n=ks(e,t,2,4);return xs(n,t),Os(n,n.length-4,r.d()),n}function _s(e,t){return Es((Ls(e),e.subarray(2,-4)),t)}function En(e,t){var r=e.length;if(!t&&typeof TextEncoder<"u")return new TextEncoder().encode(e);for(var n=new se(e.length+(e.length>>>1)),i=0,s=function(c){n[i++]=c},a=0;a<r;++a){if(i+5>n.length){var l=new se(i+8+(r-a<<1));l.set(n),n=l}var o=e.charCodeAt(a);o<128||t?s(o):o<2048?(s(192|o>>>6),s(128|o&63)):o>55295&&o<57344?(o=65536+(o&1047552)|e.charCodeAt(++a)&1023,s(240|o>>>18),s(128|o>>>12&63),s(128|o>>>6&63),s(128|o&63)):(s(224|o>>>12),s(128|o>>>6&63),s(128|o&63))}return ur(n,0,i)}function Tn(e,t){var r="";if(!t&&typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var n=0;n<e.length;){var i=e[n++];i<128||t?r+=String.fromCharCode(i):i<224?r+=String.fromCharCode((i&31)<<6|e[n++]&63):i<240?r+=String.fromCharCode((i&15)<<12|(e[n++]&63)<<6|e[n++]&63):(i=((i&15)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,r+=String.fromCharCode(55296|i>>10,56320|i&1023))}return r}const Ht="v1",po=e=>{const t=Object.assign(Object.assign({},e),{v:Ht});return Tn(Fs(En(JSON.stringify(t))),!0)},mo=e=>{if(typeof e!="string")return e;try{const t=JSON.parse(e);if(t.timestamp)return t}catch{}try{const t=JSON.parse(Tn(_s(En(e,!0))));if(t.v===Ht)return t;throw new Error(`These events were packed with packer ${t.v} which is incompatible with current packer ${Ht}.`)}catch(t){throw console.error(t),new Error("Unknown data format.")}};class xe{constructor(t){this.fileName=t.fileName||"",this.functionName=t.functionName||"",this.lineNumber=t.lineNumber,this.columnNumber=t.columnNumber}toString(){const t=this.lineNumber||"",r=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${t}:${r})`:`${this.fileName}:${t}:${r}`}}const Bs=/(^|@)\S+:\d+/,kr=/^\s*at .*(\S+:\d+|\(native\))/m,Ws=/^(eval@)?(\[native code])?$/,kt={parse:function(e){return e?typeof e.stacktrace<"u"||typeof e["opera#sourceloc"]<"u"?this.parseOpera(e):e.stack&&e.stack.match(kr)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):(console.warn("[console-record-plugin]: Failed to parse error object:",e),[]):[]},extractLocation:function(e){if(e.indexOf(":")===-1)return[e];const r=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!r)throw new Error(`Cannot parse given url: ${e}`);return[r[1],r[2]||void 0,r[3]||void 0]},parseV8OrIE:function(e){return e.stack.split(`
`).filter(function(r){return!!r.match(kr)},this).map(function(r){r.indexOf("(eval ")>-1&&(r=r.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let n=r.replace(/^\s+/,"").replace(/\(eval code/g,"(");const i=n.match(/ (\((.+):(\d+):(\d+)\)$)/);n=i?n.replace(i[0],""):n;const s=n.split(/\s+/).slice(1),a=this.extractLocation(i?i[1]:s.pop()),l=s.join(" ")||void 0,o=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return new xe({functionName:l,fileName:o,lineNumber:a[1],columnNumber:a[2]})},this)},parseFFOrSafari:function(e){return e.stack.split(`
`).filter(function(r){return!r.match(Ws)},this).map(function(r){if(r.indexOf(" > eval")>-1&&(r=r.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),r.indexOf("@")===-1&&r.indexOf(":")===-1)return new xe({functionName:r});{const n=/((.*".+"[^@]*)?[^@]*)(?:@)/,i=r.match(n),s=i&&i[1]?i[1]:void 0,a=this.extractLocation(r.replace(n,""));return new xe({functionName:s,fileName:a[0],lineNumber:a[1],columnNumber:a[2]})}},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf(`
`)>-1&&e.message.split(`
`).length>e.stacktrace.split(`
`).length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){const t=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split(`
`),n=[];for(let i=2,s=r.length;i<s;i+=2){const a=t.exec(r[i]);a&&n.push(new xe({fileName:a[2],lineNumber:parseFloat(a[1])}))}return n},parseOpera10:function(e){const t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split(`
`),n=[];for(let i=0,s=r.length;i<s;i+=2){const a=t.exec(r[i]);a&&n.push(new xe({functionName:a[3]||void 0,fileName:a[2],lineNumber:parseFloat(a[1])}))}return n},parseOpera11:function(e){return e.stack.split(`
`).filter(function(r){return!!r.match(Bs)&&!r.match(/^Error created at/)},this).map(function(r){const n=r.split("@"),i=this.extractLocation(n.pop()),a=(n.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new xe({functionName:a,fileName:i[0],lineNumber:i[1],columnNumber:i[2]})},this)}};function Us(e){if(!e||!e.outerHTML)return"";let t="";for(;e.parentElement;){let r=e.localName;if(!r)break;r=r.toLowerCase();const n=e.parentElement,i=[];if(n.children&&n.children.length>0)for(let s=0;s<n.children.length;s++){const a=n.children[s];a.localName&&a.localName.toLowerCase&&a.localName.toLowerCase()===r&&i.push(a)}i.length>1&&(r+=`:eq(${i.indexOf(e)})`),t=r+(t?">"+t:""),e=n}return t}function Yt(e){return Object.prototype.toString.call(e)==="[object Object]"}function Mn(e,t){if(t===0)return!0;const r=Object.keys(e);for(const n of r)if(Yt(e[n])&&Mn(e[n],t-1))return!0;return!1}function Le(e,t){const r={numOfKeysLimit:50,depthOfLimit:4};Object.assign(r,t);const n=[],i=[];return JSON.stringify(e,function(l,o){if(n.length>0){const c=n.indexOf(this);~c?n.splice(c+1):n.push(this),~c?i.splice(c,1/0,l):i.push(l),~n.indexOf(o)&&(n[0]===o?o="[Circular ~]":o="[Circular ~."+i.slice(0,n.indexOf(o)).join(".")+"]")}else n.push(o);if(o===null)return o;if(o===void 0)return"undefined";if(s(o))return a(o);if(o instanceof Event){const c={};for(const u in o){const d=o[u];Array.isArray(d)?c[u]=Us(d.length?d[0]:null):c[u]=d}return c}else{if(o instanceof Node)return o instanceof HTMLElement?o?o.outerHTML:"":o.nodeName;if(o instanceof Error)return o.stack?o.stack+`
End of stack for Error object`:o.name+": "+o.message}return o});function s(l){return!!(Yt(l)&&Object.keys(l).length>r.numOfKeysLimit||typeof l=="function"||Yt(l)&&Mn(l,r.depthOfLimit))}function a(l){let o=l.toString();return r.stringLengthLimit&&o.length>r.stringLengthLimit&&(o=`${o.slice(0,r.stringLengthLimit)}...`),o}}const Or={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function Vs(e,t,r){const n=r?Object.assign({},Or,r):Or,i=n.logger;if(!i)return()=>{};let s;typeof i=="string"?s=t[i]:s=i;let a=0,l=!1;const o=[];if(n.level.includes("error")){const u=f=>{const h=f.message,p=f.error,m=kt.parse(p).map(y=>y.toString()),I=[Le(h,n.stringifyOptions)];e({level:"error",trace:m,payload:I})};t.addEventListener("error",u),o.push(()=>{t.removeEventListener("error",u)});const d=f=>{let h,p;f.reason instanceof Error?(h=f.reason,p=[Le(`Uncaught (in promise) ${h.name}: ${h.message}`,n.stringifyOptions)]):(h=new Error,p=[Le("Uncaught (in promise)",n.stringifyOptions),Le(f.reason,n.stringifyOptions)]);const m=kt.parse(h).map(I=>I.toString());e({level:"error",trace:m,payload:p})};t.addEventListener("unhandledrejection",d),o.push(()=>{t.removeEventListener("unhandledrejection",d)})}for(const u of n.level)o.push(c(s,u));return()=>{o.forEach(u=>u())};function c(u,d){return u[d]?ke(u,d,f=>(...h)=>{if(f.apply(this,h),!l){l=!0;try{const p=kt.parse(new Error).map(I=>I.toString()).splice(1),m=h.map(I=>Le(I,n.stringifyOptions));a++,a<n.lengthThreshold?e({level:d,trace:p,payload:m}):a===n.lengthThreshold&&e({level:"warn",trace:[],payload:[Le("The number of log records reached the threshold.")]})}catch(p){f("rrweb logger error:",p,...h)}finally{l=!1}}}):()=>{}}}const Rn="rrweb/console@1",go=e=>({name:Rn,observer:Vs,options:e}),ut="__rrweb_original__",Ps={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],replayLogger:void 0};class Gs{constructor(t){this.config=Object.assign(Ps,t)}getConsoleLogger(){const t={};for(const r of this.config.level)r==="trace"?t[r]=n=>{(console.log[ut]?console.log[ut]:console.log)(...n.payload.map(s=>JSON.parse(s)),this.formatMessage(n))}:t[r]=n=>{(console[r][ut]?console[r][ut]:console[r])(...n.payload.map(s=>JSON.parse(s)),this.formatMessage(n))};return t}formatMessage(t){if(t.trace.length===0)return"";const r=`
	at `;let n=r;return n+=t.trace.join(r),n}}const vo=e=>{const t=(e==null?void 0:e.replayLogger)||new Gs(e).getConsoleLogger();return{handler(r,n,i){let s=null;if(r.type===R.IncrementalSnapshot&&r.data.source===w.Log?s=r.data:r.type===R.Plugin&&r.data.plugin===Rn&&(s=r.data.payload),s)try{typeof t[s.level]=="function"&&t[s.level](s)}catch(a){i.replayer.config.showWarning&&console.warn(a)}}}};function Dn(e){return{all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map(function(i){i(r)}),(n=e.get("*"))&&n.slice().map(function(i){i(t,r)})}}}const Zs=Object.freeze(Object.defineProperty({__proto__:null,default:Dn},Symbol.toStringTag,{value:"Module"}));function Hs(e=window,t=document){if("scrollBehavior"in t.documentElement.style&&e.__forceSmoothScrollPolyfill__!==!0)return;const r=e.HTMLElement||e.Element,n=468,i={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:r.prototype.scroll||o,scrollIntoView:r.prototype.scrollIntoView},s=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now;function a(y){const v=["MSIE ","Trident/","Edge/"];return new RegExp(v.join("|")).test(y)}const l=a(e.navigator.userAgent)?1:0;function o(y,v){this.scrollLeft=y,this.scrollTop=v}function c(y){return .5*(1-Math.cos(Math.PI*y))}function u(y){if(y===null||typeof y!="object"||y.behavior===void 0||y.behavior==="auto"||y.behavior==="instant")return!0;if(typeof y=="object"&&y.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+y.behavior+" is not a valid value for enumeration ScrollBehavior.")}function d(y,v){if(v==="Y")return y.clientHeight+l<y.scrollHeight;if(v==="X")return y.clientWidth+l<y.scrollWidth}function f(y,v){const g=e.getComputedStyle(y,null)["overflow"+v];return g==="auto"||g==="scroll"}function h(y){const v=d(y,"Y")&&f(y,"Y"),g=d(y,"X")&&f(y,"X");return v||g}function p(y){for(;y!==t.body&&h(y)===!1;)y=y.parentNode||y.host;return y}function m(y){const v=s();let g,b,N,T=(v-y.startTime)/n;T=T>1?1:T,g=c(T),b=y.startX+(y.x-y.startX)*g,N=y.startY+(y.y-y.startY)*g,y.method.call(y.scrollable,b,N),(b!==y.x||N!==y.y)&&e.requestAnimationFrame(m.bind(e,y))}function I(y,v,g){let b,N,T,k;const A=s();y===t.body?(b=e,N=e.scrollX||e.pageXOffset,T=e.scrollY||e.pageYOffset,k=i.scroll):(b=y,N=y.scrollLeft,T=y.scrollTop,k=o),m({scrollable:b,method:k,startTime:A,startX:N,startY:T,x:v,y:g})}e.scroll=e.scrollTo=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){i.scroll.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:e.scrollY||e.pageYOffset);return}I.call(e,t.body,arguments[0].left!==void 0?~~arguments[0].left:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:e.scrollY||e.pageYOffset)}},e.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])){i.scrollBy.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}I.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset))}},r.prototype.scroll=r.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(u(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}const y=arguments[0].left,v=arguments[0].top;I.call(this,this,typeof y>"u"?this.scrollLeft:~~y,typeof v>"u"?this.scrollTop:~~v)},r.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},r.prototype.scrollIntoView=function(){if(u(arguments[0])===!0){i.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}const y=p(this),v=y.getBoundingClientRect(),g=this.getBoundingClientRect();y!==t.body?(I.call(this,y,y.scrollLeft+g.left-v.left,y.scrollTop+g.top-v.top),e.getComputedStyle(y).position!=="fixed"&&e.scrollBy({left:v.left,top:v.top,behavior:"smooth"})):e.scrollBy({left:g.left,top:g.top,behavior:"smooth"})}}class Ys{constructor(t=[],r){this.timeOffset=0,this.raf=null,this.actions=t,this.speed=r.speed}addAction(t){const r=this.raf===!0;if(!this.actions.length||this.actions[this.actions.length-1].delay<=t.delay)this.actions.push(t);else{const n=this.findActionIndex(t);this.actions.splice(n,0,t)}r&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){const t=performance.now();for(this.timeOffset+=(t-this.lastTimestamp)*this.speed,this.lastTimestamp=t;this.actions.length;){const r=this.actions[0];if(this.timeOffset>=r.delay)this.actions.shift(),r.doAction();else break}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(this.raf!==!0&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(t){this.speed=t}isActive(){return this.raf!==null}findActionIndex(t){let r=0,n=this.actions.length-1;for(;r<=n;){const i=Math.floor((r+n)/2);if(this.actions[i].delay<t.delay)r=i+1;else if(this.actions[i].delay>t.delay)n=i-1;else return i+1}return r}}function xr(e,t){if(e.type===R.IncrementalSnapshot&&e.data.source===w.MouseMove&&e.data.positions&&e.data.positions.length){const r=e.data.positions[0].timeOffset,n=e.timestamp+r;return e.delay=n-t,n-t}return e.delay=e.timestamp-t,e.delay}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Lr(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),a=[];try{for(;(t===void 0||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a}var Ge;(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(Ge||(Ge={}));var kn={type:"xstate.init"};function Ot(e){return e===void 0?[]:[].concat(e)}function Be(e){return{type:"xstate.assign",assignment:e}}function Fr(e,t){return typeof(e=typeof e=="string"&&t&&t[e]?t[e]:e)=="string"?{type:e}:typeof e=="function"?{type:e.name,exec:e}:e}function At(e){return function(t){return e===t}}function On(e){return typeof e=="string"?{type:e}:e}function _r(e,t){return{value:e,context:t,actions:[],changed:!1,matches:At(e)}}function Br(e,t,r){var n=t,i=!1;return[e.filter(function(s){if(s.type==="xstate.assign"){i=!0;var a=Object.assign({},n);return typeof s.assignment=="function"?a=s.assignment(n,r):Object.keys(s.assignment).forEach(function(l){a[l]=typeof s.assignment[l]=="function"?s.assignment[l](n,r):s.assignment[l]}),n=a,!1}return!0}),n,i]}function xn(e,t){t===void 0&&(t={});var r=Lr(Br(Ot(e.states[e.initial].entry).map(function(a){return Fr(a,t.actions)}),e.context,kn),2),n=r[0],i=r[1],s={config:e,_options:t,initialState:{value:e.initial,actions:n,context:i,matches:At(e.initial)},transition:function(a,l){var o,c,u=typeof a=="string"?{value:a,context:e.context}:a,d=u.value,f=u.context,h=On(l),p=e.states[d];if(p.on){var m=Ot(p.on[h.type]);try{for(var I=function(D){var Z=typeof Symbol=="function"&&Symbol.iterator,S=Z&&D[Z],C=0;if(S)return S.call(D);if(D&&typeof D.length=="number")return{next:function(){return D&&C>=D.length&&(D=void 0),{value:D&&D[C++],done:!D}}};throw new TypeError(Z?"Object is not iterable.":"Symbol.iterator is not defined.")}(m),y=I.next();!y.done;y=I.next()){var v=y.value;if(v===void 0)return _r(d,f);var g=typeof v=="string"?{target:v}:v,b=g.target,N=g.actions,T=N===void 0?[]:N,k=g.cond,A=k===void 0?function(){return!0}:k,K=b===void 0,_=b??d,j=e.states[_];if(A(f,h)){var U=Lr(Br((K?Ot(T):[].concat(p.exit,T,j.entry).filter(function(D){return D})).map(function(D){return Fr(D,s._options.actions)}),f,h),3),G=U[0],z=U[1],L=U[2],F=b??d;return{value:F,context:z,actions:G,changed:b!==d||G.length>0||L,matches:At(F)}}}}catch(D){o={error:D}}finally{try{y&&!y.done&&(c=I.return)&&c.call(I)}finally{if(o)throw o.error}}}return _r(d,f)}};return s}var Wr=function(e,t){return e.actions.forEach(function(r){var n=r.exec;return n&&n(e.context,t)})};function Ln(e){var t=e.initialState,r=Ge.NotStarted,n=new Set,i={_machine:e,send:function(s){r===Ge.Running&&(t=e.transition(t,s),Wr(t,On(s)),n.forEach(function(a){return a(t)}))},subscribe:function(s){return n.add(s),s(t),{unsubscribe:function(){return n.delete(s)}}},start:function(s){if(s){var a=typeof s=="object"?s:{context:e.config.context,value:s};t={value:a.value,actions:[],context:a.context,matches:At(a.value)}}return r=Ge.Running,Wr(t,kn),i},stop:function(){return r=Ge.Stopped,n.clear(),i},get state(){return t},get status(){return r}};return i}function zs(e,t){for(let r=e.length-1;r>=0;r--){const n=e[r];if(n.type===R.Meta&&n.timestamp<=t)return e.slice(r)}return e}function Ks(e,{getCastFn:t,applyEventsSynchronously:r,emitter:n}){const i=xn({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:Be({lastPlayedEvent:(s,a)=>a.type==="CAST_EVENT"?a.payload.event:s.lastPlayedEvent}),recordTimeOffset:Be((s,a)=>{let l=s.timeOffset;return"payload"in a&&"timeOffset"in a.payload&&(l=a.payload.timeOffset),Object.assign(Object.assign({},s),{timeOffset:l,baselineTime:s.events[0].timestamp+l})}),play(s){var a;const{timer:l,events:o,baselineTime:c,lastPlayedEvent:u}=s;l.clear();for(const p of o)xr(p,c);const d=zs(o,c);let f=u==null?void 0:u.timestamp;(u==null?void 0:u.type)===R.IncrementalSnapshot&&u.data.source===w.MouseMove&&(f=u.timestamp+((a=u.data.positions[0])===null||a===void 0?void 0:a.timeOffset)),c<(f||0)&&n.emit(Y.PlayBack);const h=new Array;for(const p of d)if(!(f&&f<c&&(p.timestamp<=f||p===u)))if(p.timestamp<c)h.push(p);else{const m=t(p,!1);l.addAction({doAction:()=>{m()},delay:p.delay})}r(h),n.emit(Y.Flush),l.start()},pause(s){s.timer.clear()},resetLastPlayedEvent:Be(s=>Object.assign(Object.assign({},s),{lastPlayedEvent:null})),startLive:Be({baselineTime:(s,a)=>(s.timer.start(),a.type==="TO_LIVE"&&a.payload.baselineTime?a.payload.baselineTime:Date.now())}),addEvent:Be((s,a)=>{const{baselineTime:l,timer:o,events:c}=s;if(a.type==="ADD_EVENT"){const{event:u}=a.payload;xr(u,l);let d=c.length-1;if(!c[d]||c[d].timestamp<=u.timestamp)c.push(u);else{let p=-1,m=0;for(;m<=d;){const I=Math.floor((m+d)/2);c[I].timestamp<=u.timestamp?m=I+1:d=I-1}p===-1&&(p=m),c.splice(p,0,u)}const f=u.timestamp<l,h=t(u,f);f?h():o.isActive()&&o.addAction({doAction:()=>{h()},delay:u.delay})}return Object.assign(Object.assign({},s),{events:c})})}});return Ln(i)}function js(e){const t=xn({id:"speed",context:e,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(r,n)=>{"payload"in n&&r.timer.setSpeed(n.payload.speed)},recordSpeed:Be({normalSpeed:r=>r.timer.speed}),restoreSpeed:r=>{r.timer.setSpeed(r.normalSpeed)}}});return Ln(t)}const Xs=e=>[`.${e} { background: currentColor }`,"noscript { display: none !important; }"],Ur=new Map;function Fn(e,t){let r=Ur.get(e);return r||(r=new Map,Ur.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}function Te(e,t,r){return n=>be(this,void 0,void 0,function*(){if(n&&typeof n=="object"&&"rr_type"in n)if(r&&(r.isUnchanged=!1),n.rr_type==="ImageBitmap"&&"args"in n){const i=yield Te(e,t,r)(n.args);return yield createImageBitmap.apply(null,i)}else if("index"in n){if(r||t===null)return n;const{rr_type:i,index:s}=n;return Fn(t,i)[s]}else if("args"in n){const{rr_type:i,args:s}=n,a=window[i];return new a(...yield Promise.all(s.map(Te(e,t,r))))}else{if("base64"in n)return Bi(n.base64);if("src"in n){const i=e.get(n.src);if(i)return i;{const s=new Image;return s.src=n.src,e.set(n.src,s),s}}else if("data"in n&&n.rr_type==="Blob"){const i=yield Promise.all(n.data.map(Te(e,t,r)));return new Blob(i,{type:n.type})}}else if(Array.isArray(n))return yield Promise.all(n.map(Te(e,t,r)));return n})}function Js(e,t){try{return t===Ae.WebGL?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}catch{return null}}const Qs=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function qs(e,t){if(!(t!=null&&t.constructor))return;const{name:r}=t.constructor;if(!Qs.includes(r))return;const n=Fn(e,r);n.includes(t)||n.push(t)}function $s({mutation:e,target:t,type:r,imageMap:n,errorHandler:i}){return be(this,void 0,void 0,function*(){try{const s=Js(t,r);if(!s)return;if(e.setter){s[e.property]=e.args[0];return}const a=s[e.property],l=yield Promise.all(e.args.map(Te(n,s))),o=a.apply(s,l);qs(s,o);const c=!1}catch(s){i(e,s)}})}function eo({event:e,mutations:t,target:r,imageMap:n,errorHandler:i}){return be(this,void 0,void 0,function*(){const s=r.getContext("2d");if(!s){i(t[0],new Error("Canvas context is null"));return}const a=t.map(o=>be(this,void 0,void 0,function*(){return Promise.all(o.args.map(Te(n,s)))}));(yield Promise.all(a)).forEach((o,c)=>{const u=t[c];try{if(u.setter){s[u.property]=u.args[0];return}const d=s[u.property];u.property==="drawImage"&&typeof u.args[0]=="string"?(n.get(e),d.apply(s,u.args)):d.apply(s,o)}catch(d){i(u,d)}})})}function Vr({event:e,mutation:t,target:r,imageMap:n,canvasEventMap:i,errorHandler:s}){return be(this,void 0,void 0,function*(){try{const a=i.get(e)||t,l="commands"in a?a.commands:[a];if([Ae.WebGL,Ae.WebGL2].includes(t.type)){for(let o=0;o<l.length;o++){const c=l[o];yield $s({mutation:c,type:t.type,target:r,imageMap:n,errorHandler:s})}return}yield eo({event:e,mutations:l,target:r,imageMap:n,errorHandler:s})}catch(a){s(t,a)}})}const to=10*1e3,ro=5*1e3,no=Dn||Zs,Pr="[replayer]",xt={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Gr(e){return e.type==R.IncrementalSnapshot&&(e.data.source==w.TouchMove||e.data.source==w.MouseInteraction&&e.data.type==P.TouchStart)}class yo{get timer(){return this.service.state.context.timer}constructor(t,r){if(this.usingVirtualDom=!1,this.virtualDom=new ze,this.mouseTail=null,this.tailPositions=[],this.emitter=no(),this.legacy_missingNodeRetryMap={},this.cache=gr(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=Yr(),this.styleMirror=new ir,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastMouseDownEvent=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=l=>{this.iframe.style.display="inherit";for(const o of[this.mouseTail,this.iframe])o&&(o.setAttribute("width",String(l.width)),o.setAttribute("height",String(l.height)))},this.applyEventsSynchronously=l=>{for(const o of l){switch(o.type){case R.DomContentLoaded:case R.Load:case R.Custom:continue;case R.FullSnapshot:case R.Meta:case R.Plugin:case R.IncrementalSnapshot:break}this.getCastFn(o,!0)()}},this.getCastFn=(l,o=!1)=>{let c;switch(l.type){case R.DomContentLoaded:case R.Load:break;case R.Custom:c=()=>{this.emitter.emit(Y.CustomEvent,l)};break;case R.Meta:c=()=>this.emitter.emit(Y.Resize,{width:l.data.width,height:l.data.height});break;case R.FullSnapshot:c=()=>{var d;if(this.firstFullSnapshot){if(this.firstFullSnapshot===l){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(l,o),(d=this.iframe.contentWindow)===null||d===void 0||d.scrollTo(l.data.initialOffset),this.styleMirror.reset()};break;case R.IncrementalSnapshot:c=()=>{if(this.applyIncremental(l,o),!o&&(l===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const d of this.service.state.context.events)if(!(d.timestamp<=l.timestamp)&&this.isUserInteraction(d)){d.delay-l.delay>to*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=d);break}if(this.nextUserInteractionEvent){const d=this.nextUserInteractionEvent.delay-l.delay,f={speed:Math.min(Math.round(d/ro),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:f}),this.emitter.emit(Y.SkipStart,f)}}};break}return()=>{c&&c();for(const f of this.config.plugins||[])f.handler&&f.handler(l,o,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:l}});const d=this.service.state.context.events.length-1;if(!this.config.liveMode&&l===this.service.state.context.events[d]){const f=()=>{d<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(Y.Finish))};let h=50;l.type===R.IncrementalSnapshot&&l.data.source===w.MouseMove&&l.data.positions.length&&(h+=Math.max(0,-l.data.positions[0].timeOffset)),setTimeout(f,h)}this.emitter.emit(Y.EventCast,l)}},!(r!=null&&r.liveMode)&&t.length<2)throw new Error("Replayer need at least 2 events.");const n={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:xt,useVirtualDom:!0,logger:console};this.config=Object.assign({},n,r),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(Y.Resize,this.handleResize),this.setupDom();for(const l of this.config.plugins||[])l.getMirror&&l.getMirror({nodeMirror:this.mirror});this.emitter.on(Y.Flush,()=>{if(this.usingVirtualDom){const l={mirror:this.mirror,applyCanvas:(o,c,u)=>{Vr({event:o,mutation:c,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(o,c)=>{o.source===w.StyleSheetRule?this.applyStyleSheetRule(o,c):o.source===w.StyleDeclaration&&this.applyStyleDeclaration(o,c)},afterAppend:(o,c)=>{for(const u of this.config.plugins||[])u.onBuild&&u.onBuild(o,{id:c,replayer:this})}};if(this.iframe.contentDocument)try{St(this.iframe.contentDocument,this.virtualDom,l,this.virtualDom.mirror)}catch(o){console.warn(o)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const o in this.legacy_missingNodeRetryMap)try{const c=this.legacy_missingNodeRetryMap[o],u=bt(c.node,this.mirror,this.virtualDom.mirror);St(u,c.node,l,this.virtualDom.mirror),c.node=u}catch(c){this.warn(c)}this.constructedStyleMutations.forEach(o=>{this.applyStyleSheetMutation(o)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(o=>{this.applyAdoptedStyleSheet(o)}),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){const[l,o]=this.lastMouseDownEvent;l.dispatchEvent(o)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(Y.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});const i=new Ys([],{speed:this.config.speed});this.service=Ks({events:t.map(l=>r&&r.unpackFn?r.unpackFn(l):l).sort((l,o)=>l.timestamp-o.timestamp),timer:i,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(l=>{this.emitter.emit(Y.StateChange,{player:l})}),this.speedService=js({normalSpeed:-1,timer:i}),this.speedService.start(),this.speedService.subscribe(l=>{this.emitter.emit(Y.StateChange,{speed:l})});const s=this.service.state.context.events.find(l=>l.type===R.Meta),a=this.service.state.context.events.find(l=>l.type===R.FullSnapshot);if(s){const{width:l,height:o}=s.data;setTimeout(()=>{this.emitter.emit(Y.Resize,{width:l,height:o})},0)}a&&setTimeout(()=>{var l;this.firstFullSnapshot||(this.firstFullSnapshot=a,this.rebuildFullSnapshot(a),(l=this.iframe.contentWindow)===null||l===void 0||l.scrollTo(a.data.initialOffset))},1),this.service.state.context.events.find(Gr)&&this.mouse.classList.add("touch-device")}on(t,r){return this.emitter.on(t,r),this}off(t,r){return this.emitter.off(t,r),this}setConfig(t){Object.keys(t).forEach(r=>{t[r],this.config[r]=t[r]}),this.config.skipInactive||this.backToNormal(),typeof t.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:t.speed}}),typeof t.mouseTail<"u"&&(t.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const t=this.service.state.context.events[0],r=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:t.timestamp,endTime:r.timestamp,totalTime:r.timestamp-t.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:t,events:r}=this.service.state.context;return t-r[0].timestamp}getMirror(){return this.mirror}play(t=0){var r,n;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:t}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:t}})),(n=(r=this.iframe.contentDocument)===null||r===void 0?void 0:r.getElementsByTagName("html")[0])===null||n===void 0||n.classList.remove("rrweb-paused"),this.emitter.emit(Y.Start)}pause(t){var r,n;t===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof t=="number"&&(this.play(t),this.service.send({type:"PAUSE"})),(n=(r=this.iframe.contentDocument)===null||r===void 0?void 0:r.getElementsByTagName("html")[0])===null||n===void 0||n.classList.add("rrweb-paused"),this.emitter.emit(Y.Pause)}resume(t=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(t),this.emitter.emit(Y.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(Y.Destroy)}startLive(t){this.service.send({type:"TO_LIVE",payload:{baselineTime:t}})}addEvent(t){const r=this.config.unpackFn?this.config.unpackFn(t):t;Gr(r)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:r}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=gr()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const t=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&t.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",t.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(Hs(this.iframe.contentWindow,this.iframe.contentDocument),er(this.iframe.contentWindow))}rebuildFullSnapshot(t,r=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const n=[],i=(l,o)=>{this.collectIframeAndAttachDocument(n,l);for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(l,{id:o,replayer:this})};this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),gi(t.data.node,{doc:this.iframe.contentDocument,afterAppend:i,cache:this.cache,mirror:this.mirror}),i(this.iframe.contentDocument,t.data.node.id);for(const{mutationInQueue:l,builtNode:o}of n)this.attachDocumentToIframe(l,o),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==l);const{documentElement:s,head:a}=this.iframe.contentDocument;this.insertStyleRules(s,a),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(Y.FullsnapshotRebuilded,t),r||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(t,r){var n;const i=Xs(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&i.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const s=this.virtualDom.createElement("style");this.virtualDom.mirror.add(s,Sn(s,this.virtualDom.unserializedId)),t.insertBefore(s,r),s.rules.push({source:w.StyleSheetRule,adds:i.map((a,l)=>({rule:a,index:l}))})}else{const s=document.createElement("style");t.insertBefore(s,r);for(let a=0;a<i.length;a++)(n=s.sheet)===null||n===void 0||n.insertRule(i[a],a)}}attachDocumentToIframe(t,r){const n=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,i=[],s=(a,l)=>{this.collectIframeAndAttachDocument(i,a);const o=n.getMeta(a);if((o==null?void 0:o.type)===x.Element&&(o==null?void 0:o.tagName.toUpperCase())==="HTML"){const{documentElement:c,head:u}=r.contentDocument;this.insertStyleRules(c,u)}if(!this.usingVirtualDom)for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(a,{id:l,replayer:this})};qe(t.node,{doc:r.contentDocument,mirror:n,hackCss:!0,skipChild:!1,afterAppend:s,cache:this.cache}),s(r.contentDocument,t.node.id);for(const{mutationInQueue:a,builtNode:l}of i)this.attachDocumentToIframe(a,l),this.newDocumentQueue=this.newDocumentQueue.filter(o=>o!==a)}collectIframeAndAttachDocument(t,r){if(Ze(r,this.mirror)){const n=this.newDocumentQueue.find(i=>i.parentId===this.mirror.getId(r));n&&t.push({mutationInQueue:n,builtNode:r})}}waitForStylesheetLoad(){var t;const r=(t=this.iframe.contentDocument)===null||t===void 0?void 0:t.head;if(r){const n=new Set;let i,s=this.service.state;const a=()=>{s=this.service.state};this.emitter.on(Y.Start,a),this.emitter.on(Y.Pause,a);const l=()=>{this.emitter.off(Y.Start,a),this.emitter.off(Y.Pause,a)};r.querySelectorAll('link[rel="stylesheet"]').forEach(o=>{o.sheet||(n.add(o),o.addEventListener("load",()=>{n.delete(o),n.size===0&&i!==-1&&(s.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(Y.LoadStylesheetEnd),i&&clearTimeout(i),l())}))}),n.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(Y.LoadStylesheetStart),i=setTimeout(()=>{s.matches("playing")&&this.play(this.getCurrentTime()),i=-1,l()},this.config.loadTimeout))}}preloadAllImages(){return be(this,void 0,void 0,function*(){this.service.state;const t=()=>{this.service.state};this.emitter.on(Y.Start,t),this.emitter.on(Y.Pause,t);const r=[];for(const n of this.service.state.context.events)n.type===R.IncrementalSnapshot&&n.data.source===w.CanvasMutation&&(r.push(this.deserializeAndPreloadCanvasEvents(n.data,n)),("commands"in n.data?n.data.commands:[n.data]).forEach(s=>{this.preloadImages(s,n)}));return Promise.all(r)})}preloadImages(t,r){if(t.property==="drawImage"&&typeof t.args[0]=="string"&&!this.imageMap.has(r)){const n=document.createElement("canvas"),i=n.getContext("2d"),s=i==null?void 0:i.createImageData(n.width,n.height);s==null||s.data,JSON.parse(t.args[0]),i==null||i.putImageData(s,0,0)}}deserializeAndPreloadCanvasEvents(t,r){return be(this,void 0,void 0,function*(){if(!this.canvasEventMap.has(r)){const n={isUnchanged:!0};if("commands"in t){const i=yield Promise.all(t.commands.map(s=>be(this,void 0,void 0,function*(){const a=yield Promise.all(s.args.map(Te(this.imageMap,null,n)));return Object.assign(Object.assign({},s),{args:a})})));n.isUnchanged===!1&&this.canvasEventMap.set(r,Object.assign(Object.assign({},t),{commands:i}))}else{const i=yield Promise.all(t.args.map(Te(this.imageMap,null,n)));n.isUnchanged===!1&&this.canvasEventMap.set(r,Object.assign(Object.assign({},t),{args:i}))}}})}applyIncremental(t,r){var n,i,s;const{data:a}=t;switch(a.source){case w.Mutation:{try{this.applyMutation(a,r)}catch(l){this.warn(`Exception in mutation ${l.message||l}`,a)}break}case w.Drag:case w.TouchMove:case w.MouseMove:if(r){const l=a.positions[a.positions.length-1];this.mousePos={x:l.x,y:l.y,id:l.id,debugData:a}}else a.positions.forEach(l=>{const o={doAction:()=>{this.moveAndHover(l.x,l.y,l.id,r,a)},delay:l.timeOffset+t.timestamp-this.service.state.context.baselineTime};this.timer.addAction(o)}),this.timer.addAction({doAction(){},delay:t.delay-((n=a.positions[0])===null||n===void 0?void 0:n.timeOffset)});break;case w.MouseInteraction:{if(a.id===-1)break;const l=new Event(Me(P[a.type])),o=this.mirror.getNode(a.id);if(!o)return this.debugNodeNotFound(a,a.id);this.emitter.emit(Y.MouseInteraction,{type:a.type,target:o});const{triggerFocus:c}=this.config;switch(a.type){case P.Blur:"blur"in o&&o.blur();break;case P.Focus:c&&o.focus&&o.focus({preventScroll:!0});break;case P.Click:case P.TouchStart:case P.TouchEnd:case P.MouseDown:case P.MouseUp:r?(a.type===P.TouchStart?this.touchActive=!0:a.type===P.TouchEnd&&(this.touchActive=!1),a.type===P.MouseDown?this.lastMouseDownEvent=[o,l]:a.type===P.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:a.x,y:a.y,id:a.id,debugData:a}):(a.type===P.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(a.x,a.y,a.id,r,a),a.type===P.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):a.type===P.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):a.type===P.TouchEnd?this.mouse.classList.remove("touch-active"):o.dispatchEvent(l));break;case P.TouchCancel:r?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:o.dispatchEvent(l)}break}case w.Scroll:{if(a.id===-1)break;if(this.usingVirtualDom){const l=this.virtualDom.mirror.getNode(a.id);if(!l)return this.debugNodeNotFound(a,a.id);l.scrollData=a;break}this.applyScroll(a,r);break}case w.ViewportResize:this.emitter.emit(Y.Resize,{width:a.width,height:a.height});break;case w.Input:{if(a.id===-1)break;if(this.usingVirtualDom){const l=this.virtualDom.mirror.getNode(a.id);if(!l)return this.debugNodeNotFound(a,a.id);l.inputData=a;break}this.applyInput(a);break}case w.MediaInteraction:{const l=this.usingVirtualDom?this.virtualDom.mirror.getNode(a.id):this.mirror.getNode(a.id);if(!l)return this.debugNodeNotFound(a,a.id);const o=l;try{a.currentTime!==void 0&&(o.currentTime=a.currentTime),a.volume!==void 0&&(o.volume=a.volume),a.muted!==void 0&&(o.muted=a.muted),a.type===1&&o.pause(),a.type===0&&o.play(),a.type===4&&(o.playbackRate=a.playbackRate)}catch(c){this.warn(`Failed to replay media interactions: ${c.message||c}`)}break}case w.StyleSheetRule:case w.StyleDeclaration:{this.usingVirtualDom?a.styleId?this.constructedStyleMutations.push(a):a.id&&((i=this.virtualDom.mirror.getNode(a.id))===null||i===void 0||i.rules.push(a)):this.applyStyleSheetMutation(a);break}case w.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const l=this.virtualDom.mirror.getNode(a.id);if(!l)return this.debugNodeNotFound(a,a.id);l.canvasMutations.push({event:t,mutation:a})}else{const l=this.mirror.getNode(a.id);if(!l)return this.debugNodeNotFound(a,a.id);Vr({event:t,mutation:a,target:l,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case w.Font:{try{const l=new FontFace(a.family,a.buffer?new Uint8Array(JSON.parse(a.fontSource)):a.fontSource,a.descriptors);(s=this.iframe.contentDocument)===null||s===void 0||s.fonts.add(l)}catch(l){this.warn(l)}break}case w.Selection:{if(r){this.lastSelectionData=a;break}this.applySelection(a);break}case w.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(a):this.applyAdoptedStyleSheet(a);break}}}applyMutation(t,r){if(this.config.useVirtualDom&&!this.usingVirtualDom&&r&&(this.usingVirtualDom=!0,ys(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const c in this.legacy_missingNodeRetryMap)try{const u=this.legacy_missingNodeRetryMap[c],d=In(u.node,this.virtualDom,this.mirror);d&&(u.node=d)}catch(u){this.warn(u)}const n=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;t.removes=t.removes.filter(c=>n.getNode(c.id)?!0:(this.warnNodeNotFound(t,c.id),!1)),t.removes.forEach(c=>{var u;const d=n.getNode(c.id);if(!d)return;let f=n.getNode(c.parentId);if(!f)return this.warnNodeNotFound(t,c.parentId);if(c.isShadow&&Ee(f)&&(f=f.shadowRoot),n.removeNodeFromMap(d),f)try{f.removeChild(d),this.usingVirtualDom&&d.nodeName==="#text"&&f.nodeName==="STYLE"&&((u=f.rules)===null||u===void 0?void 0:u.length)>0&&(f.rules=[])}catch(h){if(h instanceof DOMException)this.warn("parent could not remove child in mutation",f,d,t);else throw h}});const i=Object.assign({},this.legacy_missingNodeRetryMap),s=[],a=c=>{let u=null;return c.nextId&&(u=n.getNode(c.nextId)),c.nextId!==null&&c.nextId!==void 0&&c.nextId!==-1&&!u},l=c=>{var u,d;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let f=n.getNode(c.parentId);if(!f)return c.node.type===x.Document?this.newDocumentQueue.push(c):s.push(c);c.node.isShadow&&(Ee(f)||f.attachShadow({mode:"open"}),f=f.shadowRoot);let h=null,p=null;if(c.previousId&&(h=n.getNode(c.previousId)),c.nextId&&(p=n.getNode(c.nextId)),a(c))return s.push(c);if(c.node.rootId&&!n.getNode(c.node.rootId))return;const m=c.node.rootId?n.getNode(c.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Ze(f,n)){this.attachDocumentToIframe(c,f);return}const I=(g,b)=>{if(!this.usingVirtualDom)for(const N of this.config.plugins||[])N.onBuild&&N.onBuild(g,{id:b,replayer:this})},y=qe(c.node,{doc:m,mirror:n,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:I});if(c.previousId===-1||c.nextId===-1){i[c.node.id]={node:y,mutation:c};return}const v=n.getMeta(f);if(v&&v.type===x.Element&&v.tagName==="textarea"&&c.node.type===x.Text){const g=Array.isArray(f.childNodes)?f.childNodes:Array.from(f.childNodes);for(const b of g)b.nodeType===f.TEXT_NODE&&f.removeChild(b)}else if((v==null?void 0:v.type)===x.Document){const g=f;c.node.type===x.DocumentType&&((u=g.childNodes[0])===null||u===void 0?void 0:u.nodeType)===Node.DOCUMENT_TYPE_NODE&&g.removeChild(g.childNodes[0]),y.nodeName==="HTML"&&g.documentElement&&g.removeChild(g.documentElement)}if(h&&h.nextSibling&&h.nextSibling.parentNode?f.insertBefore(y,h.nextSibling):p&&p.parentNode?f.contains(p)?f.insertBefore(y,p):f.insertBefore(y,null):f.appendChild(y),I(y,c.node.id),this.usingVirtualDom&&y.nodeName==="#text"&&f.nodeName==="STYLE"&&((d=f.rules)===null||d===void 0?void 0:d.length)>0&&(f.rules=[]),Ze(y,this.mirror)){const g=this.mirror.getId(y),b=this.newDocumentQueue.find(N=>N.parentId===g);b&&(this.attachDocumentToIframe(b,y),this.newDocumentQueue=this.newDocumentQueue.filter(N=>N!==b))}(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(i,f,y,c)};t.adds.forEach(c=>{l(c)});const o=Date.now();for(;s.length;){const c=qr(s);if(s.length=0,Date.now()-o>500){this.warn("Timeout in the loop, please check the resolve tree data:",c);break}for(const u of c)n.getNode(u.value.parentId)?tr(u,f=>{l(f)}):this.debug("Drop resolve tree since there is no parent for the root node.",u)}Object.keys(i).length&&Object.assign(this.legacy_missingNodeRetryMap,i),$r(t.texts).forEach(c=>{var u;const d=n.getNode(c.id);if(!d)return t.removes.find(f=>f.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);if(d.textContent=c.value,this.usingVirtualDom){const f=d.parentNode;((u=f==null?void 0:f.rules)===null||u===void 0?void 0:u.length)>0&&(f.rules=[])}}),t.attributes.forEach(c=>{const u=n.getNode(c.id);if(!u)return t.removes.find(d=>d.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);for(const d in c.attributes)if(typeof d=="string"){const f=c.attributes[d];if(f===null)u.removeAttribute(d);else if(typeof f=="string")try{if(d==="_cssText"&&(u.nodeName==="LINK"||u.nodeName==="STYLE"))try{const h=n.getMeta(u);Object.assign(h.attributes,c.attributes);const p=qe(h,{doc:u.ownerDocument,mirror:n,skipChild:!0,hackCss:!0,cache:this.cache}),m=u.nextSibling,I=u.parentNode;if(p&&I){I.removeChild(u),I.insertBefore(p,m),n.replace(c.id,p);break}}catch{}u.setAttribute(d,f)}catch(h){this.warn("An error occurred may due to the checkout feature.",h)}else if(d==="style"){const h=f,p=u;for(const m in h)if(h[m]===!1)p.style.removeProperty(m);else if(h[m]instanceof Array){const I=h[m];p.style.setProperty(m,I[0],I[1])}else{const I=h[m];p.style.setProperty(m,I)}}}})}applyScroll(t,r){var n,i;const s=this.mirror.getNode(t.id);if(!s)return this.debugNodeNotFound(t,t.id);const a=this.mirror.getMeta(s);if(s===this.iframe.contentDocument)(n=this.iframe.contentWindow)===null||n===void 0||n.scrollTo({top:t.y,left:t.x,behavior:r?"auto":"smooth"});else if((a==null?void 0:a.type)===x.Document)(i=s.defaultView)===null||i===void 0||i.scrollTo({top:t.y,left:t.x,behavior:r?"auto":"smooth"});else try{s.scrollTo({top:t.y,left:t.x,behavior:r?"auto":"smooth"})}catch{}}applyInput(t){const r=this.mirror.getNode(t.id);if(!r)return this.debugNodeNotFound(t,t.id);try{r.checked=t.isChecked,r.value=t.text}catch{}}applySelection(t){try{const r=new Set,n=t.ranges.map(({start:i,startOffset:s,end:a,endOffset:l})=>{const o=this.mirror.getNode(i),c=this.mirror.getNode(a);if(!o||!c)return;const u=new Range;u.setStart(o,s),u.setEnd(c,l);const d=o.ownerDocument,f=d==null?void 0:d.getSelection();return f&&r.add(f),{range:u,selection:f}});r.forEach(i=>i.removeAllRanges()),n.forEach(i=>{var s;return i&&((s=i.selection)===null||s===void 0?void 0:s.addRange(i.range))})}catch{}}applyStyleSheetMutation(t){var r;let n=null;t.styleId?n=this.styleMirror.getStyle(t.styleId):t.id&&(n=((r=this.mirror.getNode(t.id))===null||r===void 0?void 0:r.sheet)||null),n&&(t.source===w.StyleSheetRule?this.applyStyleSheetRule(t,n):t.source===w.StyleDeclaration&&this.applyStyleDeclaration(t,n))}applyStyleSheetRule(t,r){var n,i,s,a;if((n=t.adds)===null||n===void 0||n.forEach(({rule:l,index:o})=>{try{if(Array.isArray(o)){const{positions:c,index:u}=_t(o);Ve(r.cssRules,c).insertRule(l,u)}else{const c=o===void 0?void 0:Math.min(o,r.cssRules.length);r==null||r.insertRule(l,c)}}catch{}}),(i=t.removes)===null||i===void 0||i.forEach(({index:l})=>{try{if(Array.isArray(l)){const{positions:o,index:c}=_t(l);Ve(r.cssRules,o).deleteRule(c||0)}else r==null||r.deleteRule(l)}catch{}}),t.replace)try{(s=r.replace)===null||s===void 0||s.call(r,t.replace)}catch{}if(t.replaceSync)try{(a=r.replaceSync)===null||a===void 0||a.call(r,t.replaceSync)}catch{}}applyStyleDeclaration(t,r){t.set&&Ve(r.rules,t.index).style.setProperty(t.set.property,t.set.value,t.set.priority),t.remove&&Ve(r.rules,t.index).style.removeProperty(t.remove.property)}applyAdoptedStyleSheet(t){var r;const n=this.mirror.getNode(t.id);if(!n)return;(r=t.styles)===null||r===void 0||r.forEach(l=>{var o;let c=null,u=null;if(Ee(n)?u=((o=n.ownerDocument)===null||o===void 0?void 0:o.defaultView)||null:n.nodeName==="#document"&&(u=n.defaultView),!!u)try{c=new u.CSSStyleSheet,this.styleMirror.add(c,l.styleId),this.applyStyleSheetRule({source:w.StyleSheetRule,adds:l.rules},c)}catch{}});const i=10;let s=0;const a=(l,o)=>{const c=o.map(u=>this.styleMirror.getStyle(u)).filter(u=>u!==null);Ee(l)?l.shadowRoot.adoptedStyleSheets=c:l.nodeName==="#document"&&(l.adoptedStyleSheets=c),c.length!==o.length&&s<i&&(setTimeout(()=>a(l,o),0+100*s),s++)};a(n,t.styleIds)}legacy_resolveMissingNode(t,r,n,i){const{previousId:s,nextId:a}=i,l=s&&t[s],o=a&&t[a];if(l){const{node:c,mutation:u}=l;r.insertBefore(c,n),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,r,c,u)}if(o){const{node:c,mutation:u}=o;r.insertBefore(c,n.nextSibling),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,r,c,u)}}moveAndHover(t,r,n,i,s){const a=this.mirror.getNode(n);if(!a)return this.debugNodeNotFound(s,n);const l=nr(a,this.iframe),o=t*l.absoluteScale+l.x,c=r*l.absoluteScale+l.y;this.mouse.style.left=`${o}px`,this.mouse.style.top=`${c}px`,i||this.drawMouseTail({x:o,y:c}),this.hoverElements(a)}drawMouseTail(t){if(!this.mouseTail)return;const{lineCap:r,lineWidth:n,strokeStyle:i,duration:s}=this.config.mouseTail===!0?xt:Object.assign({},xt,this.config.mouseTail),a=()=>{if(!this.mouseTail)return;const l=this.mouseTail.getContext("2d");!l||!this.tailPositions.length||(l.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),l.beginPath(),l.lineWidth=n,l.lineCap=r,l.strokeStyle=i,l.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(o=>l.lineTo(o.x,o.y)),l.stroke())};this.tailPositions.push(t),a(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(l=>l!==t),a()},s/this.speedService.state.context.timer.speed)}hoverElements(t){var r;(r=this.lastHoveredRootNode||this.iframe.contentDocument)===null||r===void 0||r.querySelectorAll(".\\:hover").forEach(i=>{i.classList.remove(":hover")}),this.lastHoveredRootNode=t.getRootNode();let n=t;for(;n;)n.classList&&n.classList.add(":hover"),n=n.parentElement}isUserInteraction(t){return t.type!==R.IncrementalSnapshot?!1:t.data.source>w.Mutation&&t.data.source<=w.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(Y.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(t,r){this.warn(`Node with id '${r}' not found. `,t)}warnCanvasMutationFailed(t,r){this.warn("Has error on canvas update",r,"canvas mutation:",t)}debugNodeNotFound(t,r){this.debug(`Node with id '${r}' not found. `,t)}warn(...t){this.config.showWarning&&this.config.logger.warn(Pr,...t)}debug(...t){this.config.showDebug&&this.config.logger.log(Pr,...t)}}export{R as EventType,w as IncrementalSource,P as MouseInteractions,Rn as PLUGIN_NAME,yo as Replayer,Y as ReplayerEvents,fo as addCustomEvent,ho as freezePage,go as getRecordConsolePlugin,vo as getReplayConsolePlugin,Ft as mirror,po as pack,Ye as record,mo as unpack,io as utils};
